"use strict";(self.webpackChunkmodel_registry_ui=self.webpackChunkmodel_registry_ui||[]).push([[425],{425:(e,t,r)=>{r.d(t,{A:()=>ar});var a=r(48348),l=r.n(a),n=r(54557),o=r(85130),i=r(79438),s=r(25538),d=r(65389),m=r(98547),c=r(9226),u=r(7179);const p=()=>{const{api:e,apiAvailable:t}=(0,u.m)(),r=a.useCallback(r=>t?e.listModelVersions(r).then(e=>e):Promise.reject(new Error("API not yet available")),[e,t]);return(0,c.vT)(r,{items:[],size:0,pageSize:0,nextPageToken:""},{initialPromisePurity:!0})};var E=r(83262);const g=({getRedirectPath:e,...t})=>{const r=(0,n.useNavigate)(),{modelRegistry:l}=(0,n.useParams)();return a.createElement(E.A,{...t,onSelection:t=>{t!==l&&r(e(t))},modelRegistry:l??""})};var b=r(43711),h=r(2358),v=r(68591),y=r(7384),f=r(46103),I=r(56862);const C=({testid:e,title:t,description:r,primaryActionText:a,secondaryActionText:n,primaryActionOnClick:i,secondaryActionOnClick:s,headerIcon:d,customAction:m})=>l().createElement(o.EmptyState,{icon:d??I.GY,titleText:t,variant:o.EmptyStateVariant.sm,"data-testid":e},l().createElement(o.EmptyStateBody,null,r),l().createElement(o.EmptyStateFooter,null,a&&l().createElement(o.EmptyStateActions,null,l().createElement(o.Button,{"data-testid":"empty-model-registry-primary-action",variant:o.ButtonVariant.primary,onClick:i},a)),n&&l().createElement(o.EmptyStateActions,null,l().createElement(o.Button,{"data-testid":"empty-model-registry-secondary-action",variant:"link",onClick:s},n)),m&&l().createElement(o.EmptyStateActions,null,m)));var M,S=r(30620),A=r(63852);!function(e){e.keyword="Keyword",e.owner="Owner"}(M||(M={}));const T={[M.keyword]:"Keyword",[M.owner]:"Owner"},k={[M.keyword]:"",[M.owner]:""};var R;!function(e){e.keyword="Keyword",e.author="Author"}(R||(R={}));const w={[R.keyword]:"Keyword",[R.author]:"Author"},D={[R.keyword]:"",[R.author]:""};var x=r(62913);const V=function({filterOptions:e,filterOptionRenders:t,filterData:r,onFilterUpdate:l,children:n,testId:i="filter-toolbar",...s}){const d=Object.keys(e),[m,c]=a.useState(!1),[u,p]=a.useState(d[0]),E=r[u];return a.createElement(a.Fragment,null,a.createElement(o.ToolbarToggleGroup,{breakpoint:"md",toggleIcon:a.createElement(x.YG,null)},a.createElement(o.ToolbarGroup,{variant:"filter-group","data-testid":i,...s},a.createElement(o.ToolbarItem,null,a.createElement(o.Dropdown,{onOpenChange:e=>c(e),shouldFocusToggleOnSelect:!0,toggle:t=>a.createElement(o.MenuToggle,{"data-testid":`${i}-dropdown`,id:`${i}-toggle-button`,ref:t,"aria-label":"Filter toggle",onClick:()=>c(!m),isExpanded:m,icon:a.createElement(x.YG,null)},e[u]),isOpen:m,popperProps:{appendTo:"inline"}},a.createElement(o.DropdownList,null,d.map(t=>a.createElement(o.DropdownItem,{key:t,id:t,onClick:()=>{c(!1),p(t)}},e[t]))))),d.map(n=>{const s=e[n],d=r[n],m="string"==typeof d?{label:d,value:d}:d;return s?a.createElement(o.ToolbarFilter,{key:n,categoryName:s,"data-testid":`${i}-text-field`,labels:d&&m?[{key:n,node:a.createElement("span",{"data-testid":`${n}-filter-chip`},m.label)}]:[],deleteLabel:()=>{l(n,"")},showToolbarItem:u===n},t[n]({onChange:(e,t)=>l(n,t&&e?{label:t,value:e}:e),..."string"==typeof E?{value:E}:E})):null}))),n)};var L=r(22931),N=r(74059),F=r(58772);const P=[{field:"model name",label:"Model name",sortable:(e,t)=>e.name.localeCompare(t.name),width:35},{field:"latest version",label:"Latest version",sortable:!1,width:15},{field:"labels",label:"Labels",sortable:!1,width:35},{field:"last_modified",label:"Last modified",sortable:(e,t)=>{const r=parseInt(e.lastUpdateTimeSinceEpoch),a=parseInt(t.lastUpdateTimeSinceEpoch);return new Date(a).getTime()-new Date(r).getTime()}},{field:"owner",label:"Owner",sortable:!0,info:{popover:"The owner is the user who registered the model.",popoverProps:{position:"left"}}},{field:"kebab",label:"",sortable:!1}];var O,B=r(6735),G=r(65365),j=r(36645),_=r(52577),$=r(98112),W=r(92406),U=r(75377),H=r(44420);!function(e){e.SUCCESS="success",e.ERROR="error",e.INFO="info",e.WARNING="warning"}(O||(O={}));const K=()=>{const{notificationCount:e,updateNotificationCount:t,dispatch:r}=(0,a.useContext)(U.V),n=l().useCallback((a,l)=>{t(e+1),r({type:H.f.ADD_NOTIFICATION,payload:{status:o.AlertVariant.success,title:a,timestamp:new Date,message:l,id:e}})},[r,e,t]),i=l().useCallback((a,l)=>{t(e+1),r({type:H.f.ADD_NOTIFICATION,payload:{status:o.AlertVariant.warning,title:a,timestamp:new Date,message:l,id:e}})},[r,e,t]),s=l().useCallback((a,l)=>{t(e+1),r({type:H.f.ADD_NOTIFICATION,payload:{status:o.AlertVariant.danger,title:a,timestamp:new Date,message:l,id:e}})},[r,e,t]),d=l().useCallback((a,l)=>{t(e+1),r({type:H.f.ADD_NOTIFICATION,payload:{status:o.AlertVariant.info,title:a,timestamp:new Date,message:l,id:e}})},[r,e,t]),m=l().useCallback(e=>{r({type:H.f.DELETE_NOTIFICATION,payload:{id:e}})},[r]);return l().useMemo(()=>({success:n,error:s,info:d,warning:i,remove:m}),[n,s,d,i,m])},z=({onCancel:e,onSubmit:t,registeredModelName:r})=>{const l=K(),[n,i]=a.useState(!1),[s,d]=a.useState(),[m,c]=a.useState(""),u=m.trim()!==r||n,p=a.useCallback(()=>{c(""),e()},[e]),E=a.useCallback(async()=>{i(!0);try{await t(),p(),l.success(`${r} and all its versions archived.`)}catch(e){e instanceof Error&&d(e)}finally{i(!1)}},[t,p,l,r]);return a.createElement(o.Modal,{isOpen:!0,variant:"small",onClose:p,"data-testid":"archive-registered-model-modal"},a.createElement(o.ModalHeader,{title:"Archive model?",titleIconVariant:"warning"}),a.createElement(o.ModalBody,null,a.createElement(o.Stack,{hasGutter:!0},a.createElement(o.StackItem,null,a.createElement("b",null,r)," and all of its versions will be archived and unavailable for use unless it is restored."),a.createElement(o.StackItem,null,a.createElement(o.Flex,{direction:{default:"column"},spaceItems:{default:"spaceItemsSm"}},a.createElement(o.FlexItem,null,"Type ",a.createElement("strong",null,r)," to confirm archiving:"),a.createElement(o.TextInput,{id:"confirm-archive-input","data-testid":"confirm-archive-input","aria-label":"confirm archive input",value:m,onChange:(e,t)=>c(t),onKeyDown:e=>{"Enter"!==e.key||u||E()}}))))),a.createElement(o.ModalFooter,null,a.createElement(W.A,{onCancel:p,onSubmit:E,submitLabel:"Archive",isSubmitLoading:n,isSubmitDisabled:u,error:s,alertTitle:"Error"})))};var Y=r(70228);const q=({name:e,customProperties:t})=>{const[r,a]=l().useState(!1),[n,i]=l().useState(""),s=(0,S.IV)(t),d=s.filter(e=>e&&e.toLowerCase().includes(n.toLowerCase())),m=(0,Y._)(i),c=(e,t)=>e.map((e,r)=>l().createElement(o.Label,{variant:"outline","data-testid":"label",textMaxWidth:t||"40ch",key:r},e)),u=(e,t)=>l().createElement(o.Popover,{bodyContent:l().createElement(o.LabelGroup,{"data-testid":"popover-label-group",numLabels:e},t)},l().createElement(o.Label,{"data-testid":"popover-label-text",variant:"overflow"},e," more")),p=e=>l().createElement(o.Label,{"data-testid":"modal-label-text",variant:"overflow",onClick:()=>a(!0)},e," more"),E=r?l().createElement(o.Modal,{variant:"small",isOpen:!0,onClose:()=>a(!1)},l().createElement(o.ModalHeader,{title:"Labels",description:l().createElement(o.Content,{component:"p"},"The following are all the labels of ",l().createElement("strong",null,e))}),l().createElement(o.ModalBody,null,l().createElement(o.SearchInput,{"aria-label":"Label modal search","data-testid":"label-modal-search",placeholder:"Find a label",value:n,onChange:(e,t)=>m(t),onClear:()=>i("")}),l().createElement("br",null),l().createElement(o.LabelGroup,{"data-testid":"modal-label-group",numLabels:s.length},c(d,"50ch"))),l().createElement(o.ModalFooter,null,l().createElement(o.Button,{"data-testid":"close-modal",key:"close",variant:"primary",onClick:()=>a(!1)},"Close"))):null;return 0===Object.keys(t).length?"-":l().createElement(l().Fragment,null,l().createElement(o.LabelGroup,{numLabels:4},c(s.slice(0,3)),(e=>{const t=e.length;return t?t>4?p(t):u(t,e):null})(c(s.slice(3)))),E)};var X=r(11653);const J=({onCancel:e,onSubmit:t,registeredModelName:r})=>{const l=K(),[n,i]=a.useState(!1),[s,d]=a.useState(),m=a.useCallback(()=>{e()},[e]),c=a.useCallback(async()=>{i(!0);try{await t(),m(),l.success(`${r} and all its versions restored.`)}catch(e){e instanceof Error&&d(e)}finally{i(!1)}},[t,m,l,r]);return a.createElement(o.Modal,{isOpen:!0,variant:"small",onClose:m,"data-testid":"restore-registered-model-modal"},a.createElement(o.ModalHeader,{title:"Restore model?",titleIconVariant:"warning"}),a.createElement(o.ModalBody,null,a.createElement("b",null,r)," and all of its versions will be restored and returned to the registered models list."),a.createElement(o.ModalFooter,null,a.createElement(W.A,{onCancel:m,onSubmit:c,submitLabel:"Restore",isSubmitLoading:n,error:s,alertTitle:"Error",isSubmitDisabled:n})))};var Z=r(44352);const Q=({registeredModel:e,latestModelVersion:t,isArchiveRow:r,hasDeploys:l=!1,refresh:i})=>{const{apiState:s}=a.useContext($.m),d=(0,n.useNavigate)(),{preferredModelRegistry:m}=a.useContext(v.j),[c,u]=a.useState(!1),[p,E]=a.useState(!1),g=(0,f.Pc)(e.id,m?.name),b=(0,h.useExtensions)(B.a),y=[{title:"Overview",onClick:()=>{d(r?(0,f.Vd)(e.id,m?.name):g)}},{title:"Versions",onClick:()=>{d(r?(0,f.rq)(e.id,m?.name):(0,f.fY)(e.id,m?.name))}},{isSeparator:!0},...r?[{title:"Restore model",onClick:()=>E(!0)}]:[{title:"Archive model",onClick:()=>{l||u(!0)},isAriaDisabled:l,tooltipProps:l?{content:"Models with deployed versions cannot be archived."}:void 0}]];return a.createElement(j.Tr,null,a.createElement(G.Td,{dataLabel:"Model name"},a.createElement("div",{id:"model-name","data-testid":"model-name"},a.createElement(o.FlexItem,null,a.createElement(o.Button,{variant:"link",isInline:!0,onClick:()=>{return t=e.id,d(r?(0,f.Vd)(t,m?.name):g);var t}},a.createElement(o.Truncate,{content:e.name})))),e.description&&a.createElement(o.Content,{"data-testid":"description",component:o.ContentVariants.small},a.createElement(o.Truncate,{content:e.description}))),a.createElement(G.Td,{dataLabel:"Latest version"},t?a.createElement("div",{id:"latest-version","data-testid":"latest-version"},a.createElement(o.FlexItem,null,a.createElement(o.Button,{variant:"link",isInline:!0,onClick:()=>{return e=t,d(r?(0,f.TR)(e.id,e.registeredModelId,m?.name):(0,f.lh)(e.id,e.registeredModelId,m?.name));var e}},a.createElement(o.Truncate,{content:t.name})))):"-"),0===b.length?null:b.map((t,r)=>a.createElement(G.Td,{key:`extension-${r}`},a.createElement(h.LazyCodeRefComponent,{component:t.properties.component,props:{registeredModel:e}}))),a.createElement(G.Td,{dataLabel:"Labels"},a.createElement(q,{customProperties:e.customProperties,name:e.name})),a.createElement(G.Td,{dataLabel:"Last modified"},a.createElement(X.A,{timeSinceEpoch:e.lastUpdateTimeSinceEpoch})),a.createElement(G.Td,{dataLabel:"Owner"},a.createElement(o.Content,{component:"p","data-testid":"registered-model-owner"},e.owner||"-")),a.createElement(G.Td,{isActionCell:!0},a.createElement(_.G,{items:y}),c?a.createElement(z,{onCancel:()=>u(!1),onSubmit:()=>s.api.patchRegisteredModel({},{state:Z.ve.ARCHIVED},e.id).then(i),registeredModelName:e.name}):null,p?a.createElement(J,{onCancel:()=>E(!1),onSubmit:()=>s.api.patchRegisteredModel({},{state:Z.ve.LIVE},e.id).then(()=>d((0,f.Pc)(e.id,m?.name))),registeredModelName:e.name}):null))},ee=({clearFilters:e,registeredModels:t,modelVersions:r,toolbarContent:l,refresh:n})=>{const[o,i]=(0,h.useResolvedExtensions)(B.a),s=a.useMemo(()=>{const e=[...P];if(i&&o.length>0){const t=e.findIndex(e=>"labels"===e.field),r=t>=0?t:2;o.forEach((t,a)=>{e.splice(r+a,0,{field:`extension-${a}`,label:"Deployments",sortable:!1})})}return e},[o,i]);return a.createElement(N.A,{"data-testid":"registered-model-table",data:t,columns:s,toolbarContent:l,defaultSortColumn:2,onClearFilters:e,enablePagination:!0,emptyTableView:a.createElement(F.A,{onClearFilters:e}),rowRenderer:e=>a.createElement(Q,{key:e.name,hasDeploys:!1,registeredModel:e,latestModelVersion:(0,S.g7)(r,e.id),refresh:n})})};var te=r(77459);const re=({toggleGroupItems:e,onClearAllFilters:t})=>{const r=(0,n.useNavigate)(),{preferredModelRegistry:l}=a.useContext(v.j),[i,s]=a.useState(!1),[d,m]=a.useState(!1),c=a.useRef(null);return a.createElement(o.Toolbar,{"data-testid":"registered-models-table-toolbar",clearAllFilters:t},a.createElement(o.ToolbarContent,null,a.createElement(o.Flex,null,a.createElement(o.ToolbarToggleGroup,{toggleIcon:a.createElement(x.YG,null),breakpoint:"xl"},e),a.createElement(o.ToolbarItem,null,a.createElement(o.Dropdown,{isOpen:i,onSelect:()=>s(!1),onOpenChange:e=>s(e),toggle:e=>a.createElement(o.MenuToggle,{isFullWidth:!0,variant:"primary",ref:e,onClick:()=>s(!i),isExpanded:i,splitButtonItems:[a.createElement(o.MenuToggleAction,{id:"register-model-button",key:"register-model-button","data-testid":"register-model-button","aria-label":"Register model",onClick:()=>r((0,f.mH)(l?.name))},"Register model")],"aria-label":"Register model toggle","data-testid":"register-model-split-button"})},a.createElement(o.DropdownList,null,a.createElement(o.DropdownItem,{id:"register-new-version-button","aria-label":"Register new version",key:"register-new-version-button",onClick:()=>{r((0,f.RM)(l?.name))},ref:c},"Register new version")))),a.createElement(o.ToolbarItem,null,a.createElement(o.Dropdown,{isOpen:d,onSelect:()=>m(!1),onOpenChange:e=>m(e),toggle:e=>a.createElement(o.MenuToggle,{"data-testid":"registered-models-table-kebab-action",ref:e,variant:"plain",onClick:()=>m(!d),isExpanded:d,"aria-label":"View archived models"},a.createElement(te.bz,null)),shouldFocusToggleOnSelect:!0},a.createElement(o.DropdownList,null,a.createElement(o.DropdownItem,{onClick:()=>r((0,f.j1)(l?.name))},"View archived models")))))))},ae=({registeredModels:e,modelVersions:t,refresh:r})=>{const l=(0,n.useNavigate)(),{preferredModelRegistry:i}=a.useContext(v.j),[s,d]=a.useState(k),m=(0,A.BT)(e),c=(0,A.dI)(e),[u,p]=(0,h.useResolvedExtensions)(y.j),E=a.useCallback((e,t)=>d(r=>({...r,[e]:t})),[d]),g=a.useCallback(()=>d(k),[d]);if(0===m.length)return a.createElement(C,{testid:"empty-registered-models",title:"No models in selected registry",headerIcon:()=>a.createElement("img",{src:(0,b.z5)(b.Xf.registeredModels,"MissingModel"),alt:"missing model"}),description:`${i?.name??""} has no active registered models. Register a model in this registry, or select a different registry.`,primaryActionText:"Register model",secondaryActionText:0!==c.length?"View archived models":void 0,primaryActionOnClick:()=>{l((0,f.mH)(i?.name))},secondaryActionOnClick:()=>{l((0,f.j1)(i?.name))}});const I=(0,S.P3)(m,t,s),R=a.createElement(o.ToolbarGroup,{variant:"filter-group"},a.createElement(V,{filterOptions:T,filterOptionRenders:{[M.keyword]:({onChange:e,...t})=>a.createElement(L.A,{...t,fieldLabel:"Filter by keyword",placeholder:"Filter by keyword",className:"toolbar-fieldset-wrapper",style:{minWidth:"270px"},onChange:t=>e(t)}),[M.owner]:({onChange:e,...t})=>a.createElement(L.A,{...t,fieldLabel:"Filter by owner",placeholder:"Filter by owner",className:"toolbar-fieldset-wrapper",style:{minWidth:"270px"},onChange:t=>e(t)})},filterData:s,onFilterUpdate:E})),w=a.createElement(ee,{refresh:r,clearFilters:g,registeredModels:I,modelVersions:t,toolbarContent:a.createElement(re,{toggleGroupItems:R,onClearAllFilters:g})});return p&&u.length>0?u.reduce((e,t)=>{const r=t.properties.DeploymentsProvider;return a.createElement(r,{key:t.properties.DeploymentsProvider.toString(),mrName:i?.name},()=>w)},w):w},le=({...e})=>{const[t,r,a,n]=(0,m.A)(),[c,u,E,b]=p(),h=r&&u,v=a||E,y=l().useCallback(()=>{n(),b()},[n,b]);return l().createElement(i.A,{...e,title:l().createElement(s.A,{title:"Model Registry",objectType:d.Xf.registeredModels}),description:l().createElement(o.Stack,{hasGutter:!0},l().createElement(o.StackItem,null,"Select a model registry to view and manage your registered models. Model registries provide a structured and organized way to store, share, version, deploy, and track models."),l().createElement(o.StackItem,null,l().createElement(o.Divider,null))),headerContent:l().createElement(g,{getRedirectPath:e=>(0,f.C3)(e)}),loadError:v,loaded:h,provideChildrenPadding:!0,removeChildrenTopPadding:!0},l().createElement(ae,{registeredModels:t.items,modelVersions:c.items,refresh:y}))};var ne=r(94210),oe=r(55188),ie=r(66241),se=r(28659);const de=({title:e,modelRegistry:t})=>a.createElement(se.A,{title:e||"Model Registry not found",bodyText:(t?`Model Registry ${t}`:"The Model Registry")+" was not found."},a.createElement(g,{getRedirectPath:e=>(0,f.C3)(e),primary:!0})),me=({getInvalidRedirectPath:e})=>{const{modelRegistry:t}=(0,n.useParams)(),{modelRegistriesLoaded:r,modelRegistriesLoadError:l,modelRegistries:m,preferredModelRegistry:c,updatePreferredModelRegistry:u}=a.useContext(v.j),{isMUITheme:p}=(0,ie.w)(),E=m.find(e=>e.name===t);if(a.useEffect(()=>{E&&c?.name!==E.name&&u(E)},[E,u,c?.name]),l)return a.createElement(o.Bullseye,null,a.createElement(o.Alert,{title:"Model registry load error",variant:"danger",isInline:!0},l.message));if(!r)return a.createElement(o.Bullseye,null,"Loading model registries...");let b;if(0===m.length)b={empty:!0,emptyStatePage:a.createElement(C,{testid:"empty-model-registries-state",title:p?"Deploy a model registry":"Request access to model registries",description:p?"To deploy a new model registry, follow the instructions in the docs below.":"To request a new model registry, or to request permission to access an existing model registry, contact your administrator.",headerIcon:()=>a.createElement("img",{src:(0,d.z5)(d.Xf.registeredModels),alt:""}),customAction:p?a.createElement(ne.A,null):a.createElement(oe.A,null)}),headerContent:null};else{if(!t){const t=c??m[0];return a.createElement(n.Navigate,{to:e(t.name),replace:!0})}if(m.find(e=>e.name===t))return a.createElement($.T,{modelRegistryName:t},a.createElement(n.Outlet,null));b={empty:!0,emptyStatePage:a.createElement(de,{modelRegistry:t})}}return a.createElement(i.A,{title:a.createElement(s.A,{title:"Model Registry",objectType:d.Xf.registeredModels}),description:a.createElement(o.Stack,{hasGutter:!0},a.createElement(o.StackItem,null,"Select a model registry to view and manage your registered models. Model registries provide a structured and organized way to store, share, version, deploy, and track models."),a.createElement(o.StackItem,null,a.createElement(o.Divider,null))),headerContent:a.createElement(g,{getRedirectPath:e=>(0,f.C3)(e)}),...b,loaded:!0,provideChildrenPadding:!0})};var ce=r(57691);const ue=e=>{const{api:t,apiAvailable:r}=(0,u.m)(),l=a.useCallback(a=>r?e?t.getModelArtifactsByModelVersion(a,e):Promise.reject(new c.r1("No model registeredModel id")):Promise.reject(new Error("API not yet available")),[t,r,e]);return(0,c.vT)(l,{items:[],size:0,pageSize:0,nextPageToken:""},{initialPromisePurity:!0})},pe=e=>{const{api:t,apiAvailable:r}=(0,u.m)(),l=a.useCallback(a=>r?e?t.getRegisteredModel(a,e):Promise.reject(new c.r1("No registered model id")):Promise.reject(new Error("API not yet available")),[t,r,e]);return(0,c.vT)(l,null)};var Ee=r(96492),ge=r(11159);const be=(e,t)=>{const[r,a,n]=pe(e.registeredModelId),[o,i,s]=ue(e.id);return l().useMemo(()=>{const l=`${r?.name??""} - ${e.name}`.slice(0,63);if(0===o.size)return{modelDeployPrefillInfo:{modelName:l},registeredModel:null,loaded:a&&i,error:n||s};const d=o.items[0],m=(0,ge.v0)(d.uri);return{modelDeployPrefillInfo:{modelName:l,modelFormat:d.modelFormatName?`${d.modelFormatName} - ${d.modelFormatVersion??""}`:void 0,modelArtifactUri:d.uri,connectionTypeName:m,initialConnectionName:d.storageKey,modelRegistryInfo:{modelVersionId:e.id,registeredModelId:e.registeredModelId,mrName:t}},registeredModel:r,loaded:a&&i,error:n||s}},[o.items,o.size,s,i,e.id,e.name,e.registeredModelId,r?.name,n,a,t])},he=({mv:e,renderData:t})=>{const{apiState:r}=l().useContext($.m),{preferredModelRegistry:a}=l().useContext(v.j),n=be(e,a?.name),{modelDeployPrefillInfo:o,registeredModel:i,loaded:s,error:d}=n,m=l().useCallback(async()=>{if(i)try{await(0,Ee.N$)(r.api,i,e)}catch(e){throw new Error("Failed to update timestamps after deployment")}},[r.api,e,i]),c=s&&!d?{data:o,loaded:s,error:d}:null;return c?t(c,m):null},ve=({mv:e,render:t})=>{const r=(0,n.useNavigate)(),[a,o]=(0,h.useResolvedExtensions)(y.s),{preferredModelRegistry:i}=l().useContext(v.j),[s,d]=l().useState(!1),[m,c]=l().useState([]),u=(0,ge.Hr)(m),p=l().useCallback(()=>{d(!0)},[d]),E=l().useMemo(()=>o&&a.length>0,[o,a]),g=l().useCallback(()=>{d(!1);const t=e.id,a=e.registeredModelId,l=i?.name;r((0,f.j)(t,a,l))},[r,e,i]);return l().createElement(l().Fragment,null,a.map(e=>e.properties.useAvailablePlatformIds&&l().createElement(h.HookNotify,{key:e.uid,useHook:e.properties.useAvailablePlatformIds,onNotify:e=>c(e??[])})),t(u,p,E),s&&a.map(t=>t.properties.modalComponent&&l().createElement(he,{key:t.uid,mv:e,renderData:(e,r)=>l().createElement(t.properties.modalComponent,{modelDeployPrefill:e,onSubmit:()=>{r(),g()},onClose:()=>d(!1)})})))},ye=({registeredModel:e,latestModelVersion:t,isArchiveRow:r,hasDeploys:l=!1,loaded:i=!0,refresh:s})=>{const{apiState:d}=a.useContext($.m),m=(0,n.useNavigate)(),{preferredModelRegistry:c}=a.useContext(v.j),[u,p]=a.useState(!1),[E,g]=a.useState(!1),b=(0,f.Pc)(e.id,c?.name),h=[{title:"View model information",isDisabled:!0,className:"pf-v6-u-font-size-sm pf-v6-u-color-200 pf-v6-u-text-transform-uppercase pf-v6-u-p-xs"},{title:"Overview",onClick:()=>{m(r?(0,f.Vd)(e.id,c?.name):b)}},{title:"Versions",onClick:()=>{m(r?(0,f.rq)(e.id,c?.name):(0,f.fY)(e.id,c?.name))}},{title:"Deployments",onClick:()=>{m(`${b}/deployments`)}}],y=[{isSeparator:!0},{title:"Latest version actions",isDisabled:!0,className:"pf-v6-u-font-size-sm pf-v6-u-color-200 pf-v6-u-text-transform-uppercase pf-v6-u-p-xs"}],I=[{isSeparator:!0},...r?[{title:"Restore model",onClick:()=>g(!0)}]:[{title:"Archive model",onClick:()=>p(!0),isAriaDisabled:!i||l,tooltipProps:i&&l?{content:"Models with deployed versions cannot be archived."}:void 0}]];return a.createElement(j.Tr,null,a.createElement(G.Td,{dataLabel:"Model name"},a.createElement("div",{id:"model-name","data-testid":"model-name"},a.createElement(o.FlexItem,null,a.createElement(o.Button,{variant:"link",isInline:!0,onClick:()=>{return t=e.id,m(r?(0,f.Vd)(t,c?.name):b);var t}},a.createElement(o.Truncate,{content:e.name})))),e.description&&a.createElement(o.Content,{"data-testid":"description",component:o.ContentVariants.small},a.createElement(o.Truncate,{content:e.description}))),a.createElement(G.Td,{dataLabel:"Latest version"},t?a.createElement("div",{id:"latest-version","data-testid":"latest-version"},a.createElement(o.FlexItem,null,a.createElement(o.Button,{variant:"link",isInline:!0,onClick:()=>{return e=t,m(r?(0,f.TR)(e.id,e.registeredModelId,c?.name):(0,f.lh)(e.id,e.registeredModelId,c?.name));var e}},a.createElement(o.Truncate,{content:t.name})))):"-"),a.createElement(G.Td,{dataLabel:"Labels"},a.createElement(q,{customProperties:e.customProperties,name:e.name})),a.createElement(G.Td,{dataLabel:"Last modified"},a.createElement(X.A,{timeSinceEpoch:e.lastUpdateTimeSinceEpoch})),a.createElement(G.Td,{dataLabel:"Owner"},a.createElement(o.Content,{component:"p","data-testid":"registered-model-owner"},e.owner||"-")),a.createElement(G.Td,{isActionCell:!0},t&&!r?a.createElement(ve,{mv:t,render:(e,r,l)=>l?a.createElement(_.G,{items:[...h,...y,{title:a.createElement(a.Fragment,null,"Deploy ",a.createElement("strong",null,t.name)),onClick:r,isAriaDisabled:!e.enabled,tooltipProps:e.tooltip?{content:e.tooltip}:void 0},...I]}):a.createElement(_.G,{items:[...h,...I]})}):a.createElement(_.G,{items:[...h,...I]}),u?a.createElement(z,{onCancel:()=>p(!1),onSubmit:()=>d.api.patchRegisteredModel({},{state:Z.ve.ARCHIVED},e.id).then(s),registeredModelName:e.name}):null,E?a.createElement(J,{onCancel:()=>g(!1),onSubmit:()=>d.api.patchRegisteredModel({},{state:Z.ve.LIVE},e.id).then(()=>m((0,f.Pc)(e.id,c?.name))),registeredModelName:e.name}):null))},fe=({clearFilters:e,registeredModels:t,modelVersions:r,toolbarContent:l,refresh:n})=>a.createElement(N.A,{"data-testid":"registered-models-archive-table",data:t,columns:P,toolbarContent:l,defaultSortColumn:2,onClearFilters:e,enablePagination:!0,emptyTableView:a.createElement(F.A,{onClearFilters:e}),rowRenderer:e=>a.createElement(ye,{key:e.name,registeredModel:e,latestModelVersion:(0,S.g7)(r,e.id),isArchiveRow:!0,refresh:n})}),Ie=({registeredModels:e,modelVersions:t,refresh:r})=>{const[l,n]=a.useState(k),i=a.useCallback((e,t)=>n(r=>({...r,[e]:t})),[n]),s=a.useCallback(()=>n(k),[n]),d=(0,S.P3)(e,t,l);return 0===e.length?a.createElement(C,{headerIcon:ce.WI,testid:"empty-archive-model-state",title:"No archived models",description:"You can archive the active models that you no longer use. You can restore an archived\n      model to make it active."}):a.createElement(fe,{refresh:r,clearFilters:s,registeredModels:d,modelVersions:t,toolbarContent:a.createElement(o.Toolbar,{"data-testid":"registered-models-archive-table-toolbar",clearAllFilters:s},a.createElement(o.ToolbarContent,null,a.createElement(o.ToolbarToggleGroup,{toggleIcon:a.createElement(x.YG,null),breakpoint:"xl"},a.createElement(o.ToolbarGroup,{variant:"filter-group"},a.createElement(V,{filterOptions:T,filterOptionRenders:{[M.keyword]:({onChange:e,...t})=>a.createElement(L.A,{...t,fieldLabel:"Filter by keyword",placeholder:"Filter by keyword",className:"toolbar-fieldset-wrapper",style:{minWidth:"270px"},onChange:t=>e(t)}),[M.owner]:({onChange:e,...t})=>a.createElement(L.A,{...t,fieldLabel:"Filter by owner",placeholder:"Filter by owner",className:"toolbar-fieldset-wrapper",style:{minWidth:"270px"},onChange:t=>e(t)})},filterData:l,onFilterUpdate:i})))))})},Ce=({...e})=>{const{preferredModelRegistry:t}=l().useContext(v.j),[r,a,s,d]=(0,m.A)(),[c,u,E,g]=p(),b=a&&u,h=s||E,y=l().useCallback(()=>{d(),g()},[d,g]);return l().createElement(i.A,{...e,breadcrumb:l().createElement(o.Breadcrumb,null,l().createElement(o.BreadcrumbItem,{render:()=>l().createElement(n.Link,{to:"/model-registry"},"Model registry - ",t?.name)}),l().createElement(o.BreadcrumbItem,{"data-testid":"archive-model-page-breadcrumb",isActive:!0},"Archived models")),title:`Archived models of ${t?.name??""}`,loadError:h,loaded:b,provideChildrenPadding:!0},l().createElement(Ie,{registeredModels:(0,A.dI)(r.items),modelVersions:c.items,refresh:y}))};var Me,Se;!function(e){e.OVERVIEW="overview",e.VERSIONS="versions"}(Me||(Me={})),function(e){e.OVERVIEW="Overview",e.VERSIONS="Versions"}(Se||(Se={}));const Ae=e=>{const{api:t,apiAvailable:r}=(0,u.m)(),l=a.useCallback(a=>r?e?t.getModelVersionsByRegisteredModel(a,e):Promise.reject(new c.r1("No model registeredModel id")):Promise.reject(new Error("API not yet available")),[t,r,e]);return(0,c.vT)(l,{items:[],size:0,pageSize:0,nextPageToken:""},{initialPromisePurity:!0})},Te=({rm:e,latestModelVersion:t})=>{const{apiState:r}=a.useContext($.m),{preferredModelRegistry:l}=a.useContext(v.j),i=(0,n.useNavigate)(),[s,d]=a.useState(!1),[m,c]=a.useState(!1);return a.createElement(a.Fragment,null,a.createElement(o.Flex,null,a.createElement(o.FlexItem,null,t?a.createElement(ve,{mv:t,render:(e,r,l)=>a.createElement(o.Dropdown,{isOpen:s,onSelect:()=>d(!1),onOpenChange:e=>d(e),popperProps:{position:"end",appendTo:"inline"},toggle:e=>a.createElement(o.MenuToggle,{variant:"secondary",ref:e,onClick:()=>d(!s),isExpanded:s,"aria-label":"Model action toggle","data-testid":"model-action-toggle"},"Actions")},a.createElement(o.DropdownList,null,l&&a.createElement(o.DropdownGroup,{label:"Latest version actions"},a.createElement(o.DropdownItem,{onClick:()=>{d(!1),r()},isAriaDisabled:!e?.enabled,tooltipProps:e?.tooltip?{content:e.tooltip}:void 0},"Deploy ",a.createElement("strong",null,t.name)),l&&a.createElement(o.Divider,null)),a.createElement(o.DropdownItem,{onClick:()=>c(!0)},"Archive model")))}):a.createElement(o.Dropdown,{isOpen:s,onSelect:()=>d(!1),onOpenChange:e=>d(e),popperProps:{position:"end",appendTo:"inline"},toggle:e=>a.createElement(o.MenuToggle,{variant:"secondary",ref:e,onClick:()=>d(!s),isExpanded:s,"aria-label":"Model version action toggle","data-testid":"model-version-action-toggle"},"Actions")},a.createElement(o.DropdownList,null,a.createElement(o.DropdownGroup,null,a.createElement(o.DropdownItem,{onClick:()=>c(!0)},"Archive model")))))),m?a.createElement(z,{onCancel:()=>c(!1),onSubmit:()=>r.api.patchRegisteredModel({},{state:Z.ve.ARCHIVED},e.id).then(()=>i((0,f.Ko)(l?.name))),registeredModelName:e.name}):null)};var ke=r(19262),Re=r(10655),we=r(17209),De=r(26309),xe=r(28734),Ve=r(15402),Le=r(69375),Ne=r(97192),Fe=r(32105),Pe=r(29653),Oe=r(40167),Be=r(59779),Ge=r(44397),je=r(11438),_e=r(19398);const $e=()=>(0,_e.$)("delete.properties.modal.preference",!1),We=({modelName:e,isOpen:t,setIsOpen:r,deleteProperty:l})=>{const[n,i]=$e();return a.createElement(o.Modal,{isOpen:t,onClose:()=>r(!1),variant:o.ModalVariant.small,ouiaId:"DeletePropertyModal","aria-labelledby":"delete-property-modal-title","aria-describedby":"delete-property-modal-body","data-testid":"delete-property-modal"},a.createElement(o.ModalHeader,{title:"Delete property from all model versions?",labelId:"delete-property-modal-title"}),a.createElement(o.ModalBody,{id:"delete-property-modal-body"},a.createElement(o.Stack,{hasGutter:!0},a.createElement(o.StackItem,null,"Editing the model details will apply changes to all versions of the"," ",e?a.createElement(a.Fragment,null,a.createElement("b",null,e)," model."):a.createElement(a.Fragment,null,"model.")),a.createElement(o.StackItem,null,a.createElement(o.Checkbox,{id:"dont-show-again",label:"Don't show this again",isChecked:n,onChange:(e,t)=>i(t)})))),a.createElement(o.ModalFooter,null,a.createElement(o.Button,{key:"confirm",variant:"primary",onClick:()=>{l(),r(!1)},"data-testid":"delete-property-modal-confirm"},"Confirm"),a.createElement(o.Button,{key:"cancel",variant:"link",onClick:()=>r(!1),"data-testid":"delete-property-modal-cancel"},"Cancel")))},Ue=({isAddRow:e,isEditing:t=e,keyValuePair:r={key:"",value:""},deleteProperty:l=()=>Promise.resolve(),allExistingKeys:n,setIsEditing:i,isSavingEdits:s,setIsSavingEdits:d,isArchive:m,saveEditedProperty:c,modelName:u,showDeleteModal:p})=>{const{key:E,value:g}=r,[b,h]=a.useState(E),[v,y]=a.useState(g),[f,I]=a.useState(!0),[C,M]=a.useState(!1),[A]=$e();let T=null;b!==E&&n.includes(b)?T="Key must not match an existing property key or label":b.length>63&&(T="Key text can't exceed 63 characters");const k=()=>{h(E),y(g)},R=async()=>{d(!0);try{await l(E)}finally{d(!1)}},w=a.createElement(o.TextInput,{"data-testid":e?"add-property-key-input":`edit-property-key-input ${E}`,"aria-label":e?"Key input for new property":`Key input for editing property with key ${E}`,isRequired:!0,type:"text",autoFocus:!0,value:b,onChange:(e,t)=>h(t),validated:T?"error":"default"}),D=a.createElement(o.TextInput,{"data-testid":e?"add-property-value-input":`edit-property-value-input ${g}`,"aria-label":e?"Value input for new property":`Value input for editing property with key ${E}`,isRequired:!0,type:"text",value:v,onChange:(e,t)=>y(t)});return a.createElement(j.Tr,null,a.createElement(G.Td,{dataLabel:"Key",width:45,modifier:"breakWord"},t?a.createElement(a.Fragment,null,a.createElement(je.A,{className:"tr-fieldset-wrapper",component:w}),T&&a.createElement(o.FormHelperText,null,a.createElement(o.HelperText,null,a.createElement(o.HelperTextItem,{variant:"error"},T)))):E),a.createElement(G.Td,{dataLabel:"Value",width:45,modifier:"breakWord"},t?a.createElement(je.A,{className:"tr-fieldset-wrapper",component:D}):a.createElement(o.ExpandableSection,{variant:"truncate",truncateMaxLines:3,toggleText:f?"Show less":"Show more",onToggle:(e,t)=>I(t),isExpanded:f},(0,S.U8)(g)?a.createElement(o.Button,{variant:"link",icon:a.createElement(Oe._,null),iconPosition:"end",component:"a",href:g,target:"_blank",isInline:!0},a.createElement(o.Truncate,{content:g})):g)),!m&&a.createElement(G.Td,{isActionCell:!0,width:10},t?a.createElement(o.ActionList,{isIconList:!0},a.createElement(o.ActionListItem,null,a.createElement(o.Button,{"data-testid":"save-edit-button-property",icon:a.createElement(Be.Sr,null),"aria-label":`Save edits to property with key ${E}`,variant:"link",onClick:async()=>{d(!0);try{await c(E,{key:b,value:v})}finally{d(!1)}i(!1)},isDisabled:s||!b||!v||!!T})),a.createElement(o.ActionListItem,null,a.createElement(o.Button,{"data-testid":"discard-edit-button-property",icon:a.createElement(Ge.AX,null),"aria-label":`Discard edits to property with key ${E}`,variant:"plain",onClick:()=>{k(),i(!1)},isDisabled:s}))):a.createElement(_.G,{isDisabled:s,popperProps:{direction:"up"},items:[{title:"Edit",onClick:()=>{k(),i(!0)},isDisabled:s},{isSeparator:!0},{title:"Delete",onClick:async()=>{A||!p?await R():M(!0)},isDisabled:s}]})),a.createElement(We,{modelName:u,isOpen:C,setIsOpen:M,deleteProperty:R}))},He=({customProperties:e={},isArchive:t,saveEditedCustomProperties:r,isExpandedByDefault:a=!1,onEditingChange:n,modelName:i})=>{const[s,d]=l().useState([]),[m,c]=l().useState(!1),u=m||s.length>0,[p,E]=l().useState(!1),g=(0,S.oY)(e),[b,h]=l().useState(!1),v=Object.keys(g),y=v.length>5,f=b?v:v.slice(0,5),I=v.length-f.length,C=Object.keys(e),M=l().createElement("span",{"aria-hidden":"true",className:Pe.A.textColorStatusDanger}," *"),[A,T]=l().useState(a);return l().useEffect(()=>{n?.(u)},[u,n]),l().createElement(o.ExpandableSection,{isExpanded:A,onToggle:()=>T(!A),"data-testid":"properties-expandable-section",toggleContent:l().createElement(l().Fragment,null,"Properties ",l().createElement(o.Badge,{isRead:!0},v.length))},v.length>0&&l().createElement(xe.X,{"aria-label":"Properties table","data-testid":"properties-table",variant:"compact"},l().createElement(Ve.d,null,l().createElement(j.Tr,null,l().createElement(Le.Th,null,"Key ",u&&M),l().createElement(Le.Th,null,"Value ",u&&M),l().createElement(Le.Th,{screenReaderText:"Actions"}))),l().createElement(Ne.N,null,f.map(a=>l().createElement(Ue,{key:a,modelName:i,isArchive:t,keyValuePair:{key:a,value:g[a].string_value||""},allExistingKeys:C,isEditing:s.includes(a),setIsEditing:e=>((e,t)=>d([...s.filter(t=>t!==e),...t?[e]:[]]))(a,e),isSavingEdits:p,setIsSavingEdits:E,showDeleteModal:!!n,saveEditedProperty:(t,a)=>r((0,S.FV)({customProperties:e,op:"update",oldKey:t,newPair:a})),deleteProperty:t=>r((0,S.FV)({customProperties:e,op:"delete",oldKey:t}))})),m&&l().createElement(Ue,{isAddRow:!0,allExistingKeys:C,setIsEditing:c,isSavingEdits:p,setIsSavingEdits:E,saveEditedProperty:(t,a)=>r((0,S.FV)({customProperties:e,op:"create",newPair:a}))}))),!t&&l().createElement(o.Button,{variant:"link","data-testid":"add-property-button",icon:l().createElement(De.uI,null),isDisabled:m||p,onClick:()=>{h(!0),c(!0)}},"Add property"),y&&l().createElement(o.Button,{variant:"link",className:Fe.A.mtSm,"data-testid":"expand-control-button",onClick:()=>h(!b)},b?"Show fewer properties":`Show ${I} more ${1===I?"property":"properties"}`))},Ke=({registeredModel:e,refresh:t,isArchiveModel:r,isExpandable:a})=>{const{apiState:n}=l().useContext($.m),[i,s]=l().useState(!1),[d,m]=l().useState({labels:!1,description:!1,properties:!1}),c=Object.values(d).some(e=>e),u=l().useCallback(e=>{m(t=>({...t,labels:e}))},[]),p=l().useCallback(e=>{m(t=>({...t,description:e}))},[]),E=l().useCallback(e=>{m(t=>({...t,properties:e}))},[]),g=l().createElement(ke.A,{labels:(0,S.IV)(e.customProperties),isArchive:r,allExistingKeys:Object.keys(e.customProperties),title:"Labels",contentWhenEmpty:"No labels",onLabelsChange:r=>n.api.patchRegisteredModel({},{customProperties:(0,S.Dh)(e.customProperties,r)},e.id).then(t),isCollapsible:!1,labelProps:{variant:"outline"},onEditingChange:a?u:void 0}),b=l().createElement(Re.A,{truncateMaxLines:3,editableVariant:"TextArea",baseTestId:"model-description",title:"Description",isArchive:r,contentWhenEmpty:"No description",value:e.description||"",saveEditedValue:r=>n.api.patchRegisteredModel({},{description:r},e.id).then(t),onEditingChange:a?p:void 0}),h=l().createElement(l().Fragment,null,l().createElement(we.A,{title:"Owner",popover:"The owner is the user who registered the model."},l().createElement(o.Content,{component:"p","data-testid":"registered-model-owner"},e.owner||"-")),l().createElement(we.A,{title:"Model ID"},l().createElement(o.ClipboardCopy,{hoverTip:"Copy",clickTip:"Copied",variant:"inline-compact","data-testid":"registered-model-id-clipboard-copy"},e.id)),l().createElement(we.A,{isEmpty:!e.lastUpdateTimeSinceEpoch,contentWhenEmpty:"Unknown",title:"Last modified"},l().createElement(X.A,{timeSinceEpoch:e.lastUpdateTimeSinceEpoch})),l().createElement(we.A,{isEmpty:!e.createTimeSinceEpoch,contentWhenEmpty:"Unknown",title:"Created"},l().createElement(X.A,{timeSinceEpoch:e.createTimeSinceEpoch}))),v=l().createElement(He,{modelName:e.name,isArchive:r,customProperties:e.customProperties,saveEditedCustomProperties:r=>n.api.patchRegisteredModel({},{customProperties:r},e.id).then(t),onEditingChange:a?E:void 0}),y=l().createElement(l().Fragment,null,a&&c&&l().createElement(o.CardBody,null,l().createElement(o.Alert,{variant:"info",title:"Changes affect all model versions",ouiaId:"InfoAlert","data-testid":"edit-alert"},l().createElement("p",null,"Editing the model details will apply changes to all versions of the ",l().createElement("b",null,e.name)," ","model."))),l().createElement(o.CardBody,null,a?l().createElement(o.Sidebar,{hasBorder:!0,hasGutter:!0,isPanelRight:!0},l().createElement(o.SidebarContent,null,l().createElement(o.DescriptionList,null,g,b,v)),l().createElement(o.SidebarPanel,{width:{default:"width_33"}},l().createElement(o.DescriptionList,null,h))):l().createElement(o.Stack,{hasGutter:!0},l().createElement(o.StackItem,null,l().createElement(o.DescriptionList,null,g,b)),l().createElement(o.StackItem,null,l().createElement(o.DescriptionList,{columnModifier:{default:"1Col",md:"2Col"}},h)),l().createElement(o.StackItem,null,v))));return l().createElement(o.Card,{isExpanded:i,style:{overflow:"visible"}},a?l().createElement(l().Fragment,null,l().createElement(o.CardHeader,{onExpand:()=>s(!i),toggleButtonProps:{id:"toggle-button1","data-testid":"model-details-card-toggle-button","aria-label":"Details","aria-expanded":i}},l().createElement(o.CardTitle,null,"Model details")),l().createElement(o.CardExpandableContent,{"data-testid":"model-details-card-expandable-content"},y)):l().createElement(l().Fragment,null,l().createElement(o.CardTitle,null,"Model details"),y))};var ze=r(26467),Ye=r(86161);const qe=({rmId:e,totalVersions:t,isArchiveModel:r,showIcon:l=!1})=>{const{preferredModelRegistry:i}=a.useContext(v.j);return a.createElement(n.Link,{to:r?(0,f.rq)(e,i?.name):(0,f.fY)(e,i?.name),style:{textDecoration:"none"}},a.createElement(o.Button,{isInline:!0,"data-testid":"versions-route-link",variant:"link",icon:l?a.createElement(Ye.fl,null):void 0,iconPosition:l?"right":void 0},`View all ${t} versions`))},Xe=({rm:e,isArchiveModel:t})=>{const[r]=Ae(e.id),{preferredModelRegistry:l}=a.useContext(v.j),i=t?r.items:(0,A._u)(r.items),s=i.toSorted((e,t)=>Number(t.createTimeSinceEpoch)-Number(e.createTimeSinceEpoch)).slice(0,3);return a.createElement(o.Card,null,a.createElement(o.CardTitle,null,"Latest versions"),a.createElement(o.CardBody,null,a.createElement(o.Divider,null),s.length>0?a.createElement(o.List,{isPlain:!0,isBordered:!0},s.map(r=>a.createElement(o.ListItem,{key:r.id,className:"pf-v6-u-py-md","data-testid":`model-version-${r.id}`},a.createElement(o.Flex,{spaceItems:{default:"spaceItemsXs"},direction:{default:"column"}},a.createElement(o.FlexItem,null,a.createElement(n.Link,{to:t?(0,f.TR)(r.id,e.id,l?.name):(0,f.lh)(r.id,e.id,l?.name),style:{textDecoration:"none"}},a.createElement(o.Button,{isInline:!0,"data-testid":`model-version-${r.id}-link`,variant:"link"},a.createElement(o.Truncate,{content:r.name})))),a.createElement(o.FlexItem,null,a.createElement(ze.A,{content:r.description,maxLines:1})),a.createElement(o.FlexItem,null,a.createElement(o.LabelGroup,null,(0,S.IV)(r.customProperties).map(e=>a.createElement(o.Label,{variant:"outline",key:e,"data-testid":`model-version-${r.id}-property-${e}`},e))))))),a.createElement(o.ListItem,{className:"pf-v6-u-pt-md"},a.createElement(qe,{rmId:e.id,totalVersions:i.length,isArchiveModel:t,showIcon:!0}))):a.createElement("div",{className:"pf-v6-u-pt-md","data-testid":"no-versions-text"},"No versions")))};var Je=r(40487),Ze=r(62127);const Qe=({registeredModel:e,refresh:t,isArchiveModel:r})=>{const{modelRegistry:l}=(0,Ze.useParams)(),n=(0,h.useExtensions)(Je.S).map(t=>a.createElement(h.LazyCodeRefComponent,{key:t.uid,component:t.properties.component,props:{mrName:l,rmId:e.id}}));return a.createElement(o.Grid,{hasGutter:!0},a.createElement(o.GridItem,{span:12,lg:8},a.createElement(Ke,{registeredModel:e,refresh:t,isArchiveModel:r})),a.createElement(o.GridItem,{span:12,lg:4},a.createElement(o.Stack,{hasGutter:!0},a.createElement(Xe,{rm:e,isArchiveModel:r}),n)))},et=({onCancel:e,onSubmit:t,modelVersionName:r})=>{const l=K(),[n,i]=a.useState(!1),[s,d]=a.useState(),[m,c]=a.useState(""),u=m.trim()!==r||n,p=a.useCallback(()=>{c(""),e()},[e]),E=a.useCallback(async()=>{i(!0);try{await t(),p(),l.success(`${r} archived.`)}catch(e){e instanceof Error&&d(e)}finally{i(!1)}},[t,p,l,r]);return a.createElement(o.Modal,{isOpen:!0,variant:"small",onClose:p,"data-testid":"archive-model-version-modal"},a.createElement(o.ModalHeader,{title:"Archive model version?",titleIconVariant:"warning"}),a.createElement(o.ModalBody,null,a.createElement(o.Stack,{hasGutter:!0},a.createElement(o.StackItem,null,a.createElement("b",null,r)," will be archived and unavailable for use unless it is restored."),a.createElement(o.StackItem,null,a.createElement(o.Flex,{direction:{default:"column"},spaceItems:{default:"spaceItemsSm"}},a.createElement(o.FlexItem,null,"Type ",a.createElement("strong",null,r)," to confirm archiving:"),a.createElement(o.TextInput,{id:"confirm-archive-input","data-testid":"confirm-archive-input","aria-label":"confirm archive input",value:m,onChange:(e,t)=>c(t),onKeyDown:e=>{"Enter"!==e.key||u||E()}}))))),a.createElement(o.ModalFooter,null,a.createElement(W.A,{onCancel:p,onSubmit:E,submitLabel:"Archive",isSubmitLoading:n,isSubmitDisabled:u,error:s,alertTitle:"Error"})))},tt=({onCancel:e,onSubmit:t,modelVersionName:r})=>{const l=K(),[n,i]=a.useState(!1),[s,d]=a.useState(),m=a.useCallback(()=>{e()},[e]),c=a.useCallback(async()=>{i(!0);try{await t(),m(),l.success(`${r} restored.`)}catch(e){e instanceof Error&&d(e)}finally{i(!1)}},[t,m,l,r]);return a.createElement(o.Modal,{isOpen:!0,variant:"small",onClose:m,"data-testid":"restore-model-version-modal"},a.createElement(o.ModalHeader,{title:"Restore model version?",titleIconVariant:"warning"}),a.createElement(o.ModalBody,null,a.createElement("b",null,r)," will be restored and returned to the versions list."),a.createElement(o.ModalFooter,null,a.createElement(W.A,{onCancel:m,onSubmit:c,submitLabel:"Restore",isSubmitLoading:n,error:s,alertTitle:"Error",isSubmitDisabled:n})))},rt=({mv:e,actions:t})=>l().createElement(ve,{mv:e,render:(e,r,a)=>a?l().createElement(_.G,{items:[{title:"Deploy",onClick:r,isAriaDisabled:!e.enabled,tooltipProps:e.tooltip?void 0:{content:e.tooltip}},...t]}):l().createElement(_.G,{items:t})}),at=({modelVersion:e,isArchiveRow:t,isArchiveModel:r,hasDeployment:l,loaded:i=!0,refresh:s})=>{const d=(0,n.useNavigate)(),{preferredModelRegistry:m}=a.useContext(v.j),{apiState:c}=a.useContext($.m),[u,p]=a.useState(!1),[E,g]=a.useState(!1);if(!m)return null;const b=t?[{title:"Restore model version",onClick:()=>g(!0)}]:[{isSeparator:!0},{title:"Archive model version",onClick:()=>p(!0),isAriaDisabled:!i||l,tooltipProps:i&&l?{content:"Deployed model versions cannot be archived"}:void 0}];return a.createElement(j.Tr,null,a.createElement(G.Td,{dataLabel:"Version name"},a.createElement("div",{id:"model-version-name","data-testid":"model-version-name"},a.createElement(o.FlexItem,null,a.createElement(n.Link,{to:r?(0,f.TR)(e.id,e.registeredModelId,m.name):t?(0,f.Zf)(e.id,e.registeredModelId,m.name):(0,f.lh)(e.id,e.registeredModelId,m.name)},a.createElement(o.Truncate,{content:e.name})))),e.description&&a.createElement(o.Content,{"data-testid":"model-version-description",component:o.ContentVariants.small},a.createElement(o.Truncate,{content:e.description}))),a.createElement(G.Td,{dataLabel:"Last modified"},a.createElement(X.A,{timeSinceEpoch:e.lastUpdateTimeSinceEpoch})),a.createElement(G.Td,{dataLabel:"Author"},e.author),a.createElement(G.Td,{dataLabel:"Labels"},a.createElement(q,{customProperties:e.customProperties,name:e.name})),!r&&a.createElement(G.Td,{isActionCell:!0},a.createElement(rt,{mv:e,actions:b}),u?a.createElement(et,{onCancel:()=>p(!1),onSubmit:()=>c.api.patchModelVersion({},{state:Z.ve.ARCHIVED},e.id).then(s),modelVersionName:e.name}):null,E?a.createElement(tt,{onCancel:()=>g(!1),onSubmit:()=>c.api.patchModelVersion({},{state:Z.ve.LIVE},e.id).then(()=>d((0,f.lh)(e.id,e.registeredModelId,m.name))),modelVersionName:e.name}):null))},lt=l().createContext({deployments:void 0,loaded:!1}),nt=()=>l().useContext(lt);var ot;!function(e){e.DASHBOARD_RESOURCE="opendatahub.io/dashboard",e.PROJECT_SHARING="opendatahub.io/project-sharing",e.MODEL_SERVING_PROJECT="modelmesh-enabled",e.DATA_CONNECTION_AWS="opendatahub.io/managed",e.LABEL_SELECTOR_MODEL_REGISTRY="component=model-registry",e.LABEL_SELECTOR_DATA_SCIENCE_PIPELINES="data-science-pipelines",e.PROJECT_SUBJECT="opendatahub.io/rb-project-subject",e.REGISTERED_MODEL_ID="modelregistry.opendatahub.io/registered-model-id",e.MODEL_VERSION_ID="modelregistry.opendatahub.io/model-version-id",e.MODEL_REGISTRY_NAME="modelregistry.opendatahub.io/name",e.KUEUE_MANAGED="kueue.openshift.io/managed"}(ot||(ot={}));const it=({children:e,labelSelectors:t,mrName:r})=>{const[a,n]=(0,h.useResolvedExtensions)(y.j),o=l().useMemo(()=>n&&a?.[0]?.properties.DeploymentsProvider,[n,a]);return n&&o?l().createElement(o,{labelSelectors:t,mrName:r},t=>l().createElement(lt.Provider,{value:t},e)):e},st=({data:e,columns:t,defaultSortColumn:r,enablePagination:l,onClearFilters:n,emptyTableView:o,toolbarContent:i,isArchiveModel:s,refresh:d,...m})=>{const{deployments:c,loaded:u}=nt();return a.createElement(N.A,{data:e,columns:t,toolbarContent:i,defaultSortColumn:r,enablePagination:l,onClearFilters:n,emptyTableView:o,rowRenderer:e=>{return a.createElement(at,{key:e.name,modelVersion:e,isArchiveModel:s,refresh:d,hasDeployment:(t=e.id,!!c?.some(e=>"InferenceService"===e.model.kind&&e.model.metadata.labels?.[ot.MODEL_VERSION_ID]===t)&&u)});var t},...m})},dt=({data:e,columns:t,toolbarContent:r,defaultSortColumn:l,enablePagination:n,onClearFilters:o,emptyTableView:i,isArchiveModel:s,refresh:d,rm:m,...c})=>{const u={[ot.REGISTERED_MODEL_ID]:m.id},{preferredModelRegistry:p}=a.useContext(v.j);return a.createElement(it,{labelSelectors:u,mrName:p?.name},a.createElement(st,{data:e,columns:t,defaultSortColumn:l,enablePagination:n,onClearFilters:o,emptyTableView:i,toolbarContent:r,isArchiveModel:s,refresh:d,...c}))},mt=[{field:"version name",label:"Version name",sortable:(e,t)=>e.name.localeCompare(t.name),width:40},{field:"last_modified",label:"Last modified",sortable:(e,t)=>{const r=parseInt(e.lastUpdateTimeSinceEpoch),a=parseInt(t.lastUpdateTimeSinceEpoch);return new Date(a).getTime()-new Date(r).getTime()}},{field:"author",label:"Author",sortable:(e,t)=>{const r=e.author||"",a=t.author||"";return r.localeCompare(a)},info:{popover:"The author is the user who registered the model version."}},{field:"labels",label:"Labels",sortable:!1,width:35},{field:"kebab",label:"",sortable:!1}],ct=({clearFilters:e,modelVersions:t,toolbarContent:r,isArchiveModel:l,refresh:n,rm:o})=>a.createElement(dt,{"data-testid":"model-versions-table",data:t,columns:mt,toolbarContent:r,defaultSortColumn:3,enablePagination:!0,onClearFilters:e,emptyTableView:a.createElement(F.A,{onClearFilters:e}),isArchiveModel:l,refresh:n,rm:o}),ut=({modelVersions:e,registeredModel:t,isArchiveModel:r,refresh:l})=>{const i=r?e:(0,A._u)(e),s=(0,A.SD)(e),m=(0,n.useNavigate)(),{preferredModelRegistry:c}=a.useContext(v.j),[u,p]=a.useState(D),E=a.useCallback((e,t)=>p(r=>({...r,[e]:t})),[p]),g=a.useCallback(()=>p(D),[p]),[b,h]=a.useState(!1),y=(0,S.PN)(i,u),I=t.lastUpdateTimeSinceEpoch&&new Date(parseInt(t.lastUpdateTimeSinceEpoch));return 0===i.length?r?a.createElement(C,{testid:"empty-archive-model-versions",title:"No versions",headerIcon:()=>a.createElement("img",{src:(0,d.z5)(d.Xf.registeredModels,"MissingVersion"),alt:"missing version"}),description:`${t.name} has no registered versions.`}):a.createElement(C,{testid:"empty-model-versions",title:"No versions",headerIcon:()=>a.createElement("img",{src:(0,d.z5)(d.Xf.registeredModels,"MissingVersion"),alt:"missing version"}),description:`${t.name} has no registered versions. Register a version to this model.`,primaryActionText:"Register new version",primaryActionOnClick:()=>{m((0,f.Tj)(t.id,c?.name))},secondaryActionText:0!==s.length?"View archived versions":void 0,secondaryActionOnClick:()=>{m((0,f.xi)(t.id,c?.name))}}):a.createElement(a.Fragment,null,r&&a.createElement(o.Alert,{variant:"warning",isInline:!0,title:`All the versions have been archived along with the model on ${I?`${I.toLocaleString("en-US",{month:"long",timeZone:"UTC"})} ${I.getUTCDate()}, ${I.getUTCFullYear()}`:"--"}. They are now read-only and can only be restored together with the model.`}),a.createElement(ct,{refresh:l,isArchiveModel:r,clearFilters:g,modelVersions:(0,S.ht)(y),rm:t,toolbarContent:a.createElement(o.Toolbar,{"data-testid":"model-versions-table-toolbar",clearAllFilters:g},a.createElement(o.ToolbarContent,null,a.createElement(o.Flex,null,a.createElement(o.ToolbarToggleGroup,{toggleIcon:a.createElement(x.YG,null),breakpoint:"xl"},a.createElement(o.ToolbarGroup,{variant:"filter-group"},a.createElement(V,{filterOptions:w,filterOptionRenders:{[R.keyword]:({onChange:e,...t})=>a.createElement(L.A,{...t,fieldLabel:"Filter by keyword",placeholder:"Filter by keyword",className:"toolbar-fieldset-wrapper",style:{minWidth:"270px"},onChange:t=>e(t)}),[R.author]:({onChange:e,...t})=>a.createElement(L.A,{...t,fieldLabel:"Filter by author",placeholder:"Filter by author",className:"toolbar-fieldset-wrapper",style:{minWidth:"270px"},onChange:t=>e(t)})},filterData:u,onFilterUpdate:E}))),!r&&a.createElement(o.ToolbarGroup,null,a.createElement(o.ToolbarItem,null,a.createElement(o.Button,{variant:"primary",onClick:()=>{m((0,f.Tj)(t.id,c?.name))}},"Register new version")),a.createElement(o.ToolbarItem,null,a.createElement(o.Dropdown,{isOpen:b,onSelect:()=>h(!1),onOpenChange:e=>h(e),toggle:e=>a.createElement(o.MenuToggle,{"data-testid":"model-versions-table-kebab-action",ref:e,variant:"plain",onClick:()=>h(!b),isExpanded:b,"aria-label":"View archived versions"},a.createElement(te.bz,null)),shouldFocusToggleOnSelect:!0,popperProps:{appendTo:"inline"}},a.createElement(o.DropdownList,null,a.createElement(o.DropdownItem,{onClick:()=>m((0,f.xi)(t.id,c?.name))},"View archived versions"))))))))}))};var pt=r(15041);const Et=({tab:e,registeredModel:t,modelVersions:r,refresh:l,isArchiveModel:i,mvRefresh:s})=>{const d=(0,n.useNavigate)(),m=(0,h.useExtensions)(pt.x),{registeredModelId:c}=(0,n.useParams)(),{preferredModelRegistry:u}=a.useContext(v.j),p=[a.createElement(o.Tab,{key:Me.OVERVIEW,eventKey:Me.OVERVIEW,title:a.createElement(o.TabTitleText,null,Se.OVERVIEW),"aria-label":"Model Overview tab","data-testid":"model-overview-tab"},a.createElement(o.PageSection,{hasBodyWrapper:!1,isFilled:!0,"data-testid":"model-details-tab-content"},a.createElement(Qe,{registeredModel:t,refresh:l,isArchiveModel:i}))),a.createElement(o.Tab,{key:Me.VERSIONS,eventKey:Me.VERSIONS,title:a.createElement(o.TabTitleText,null,Se.VERSIONS),"aria-label":"Model versions tab","data-testid":"model-versions-tab"},a.createElement(o.PageSection,{hasBodyWrapper:!0,isFilled:!0,"data-testid":"model-versions-tab-content"},a.createElement(ut,{isArchiveModel:i,modelVersions:r,registeredModel:t,refresh:s}))),...m.map(e=>a.createElement(o.Tab,{key:e.properties.id,eventKey:e.properties.id,"aria-label":`${e.properties.title} tab`,"data-testid":`${e.properties.id}-tab`,title:a.createElement(o.TabTitleText,null,e.properties.title)},a.createElement(o.PageSection,{hasBodyWrapper:!1,isFilled:!0,"data-testid":`${e.properties.id}-tab-content`},a.createElement(h.LazyCodeRefComponent,{component:e.properties.component,props:{rmId:c,mrName:u?.name}}))))];return a.createElement(o.Tabs,{activeKey:e,"aria-label":"Model versions page tabs",role:"region","data-testid":"model-versions-page-tabs",onSelect:(e,t)=>d(`../${t}`,{relative:"path"})},p)},gt=({tab:e,...t})=>{const{preferredModelRegistry:r}=l().useContext(v.j),{registeredModelId:s}=(0,n.useParams)(),[d,m,c,u]=Ae(s),[p,E,g,b]=pe(s),h=c||g,y=m&&E,I=(0,n.useNavigate)(),C=l().useMemo(()=>{if(!d.items?.length)return;return d.items.filter(e=>e.state!==Z.ve.ARCHIVED).toSorted((e,t)=>Number(t.createTimeSinceEpoch)-Number(e.createTimeSinceEpoch))[0]},[d.items]);return(0,a.useEffect)(()=>{p?.state===Z.ve.ARCHIVED&&I((0,f.Vd)(p.id,r?.name))},[p?.state,p?.id,r?.name,I]),l().createElement(i.A,{...t,breadcrumb:l().createElement(o.Breadcrumb,null,l().createElement(o.BreadcrumbItem,{render:()=>l().createElement(n.Link,{to:"/model-registry"},"Model registry - ",r?.name)}),l().createElement(o.BreadcrumbItem,{"data-testid":"breadcrumb-model",isActive:!0},p?.name||"Loading...")),title:p?.name,headerAction:p&&l().createElement(Te,{rm:p,latestModelVersion:C}),loadError:h,loaded:y,provideChildrenPadding:!0},null!==p&&l().createElement(Et,{tab:e,registeredModel:p,refresh:b,mvRefresh:u,modelVersions:d.items}))},bt=e=>{const{preferredModelRegistry:t}=l().useContext(v.j),{registeredModelId:r}=(0,n.useParams)(),a=l().useMemo(()=>r?{[ot.REGISTERED_MODEL_ID]:r}:void 0,[r]);return l().createElement(it,{labelSelectors:a,mrName:t?.name},l().createElement(gt,{...e}))};var ht,vt;!function(e){e.DETAILS="details"}(ht||(ht={})),function(e){e.DETAILS="Details"}(vt||(vt={}));const yt=e=>{const{api:t,apiAvailable:r}=(0,u.m)(),l=a.useCallback(a=>r?e?t.getModelVersion(a,e):Promise.reject(new c.r1("No model version id")):Promise.reject(new Error("API not yet available")),[t,r,e]);return(0,c.vT)(l,null)},ft=({rmId:e,selection:t,onSelect:r})=>{const[l,n]=a.useState(!1),[i,s]=a.useState(""),d=a.useRef(null),m=a.useRef(null),[c]=Ae(e),u=(0,A._u)(c.items),p=u.reduce((e,t)=>null===e||Number(t.createTimeSinceEpoch)>Number(e.createTimeSinceEpoch)?t:e,null),E=u.filter(e=>""===i||e.name.toLowerCase().includes(i.toLowerCase())).toSorted((e,t)=>Number(t.createTimeSinceEpoch)-Number(e.createTimeSinceEpoch)).map((e,r)=>a.createElement(o.MenuItem,{isSelected:e.id===t.id,itemId:e.id,key:r},a.createElement(o.Flex,{spaceItems:{default:"spaceItemsSm"}},a.createElement(o.FlexItem,null,e.name),a.createElement(o.FlexItem,null,p&&e.id===p.id&&a.createElement(o.Badge,{color:"blue"},"Latest")))));i.length>0&&0===u.length&&E.push(a.createElement(o.MenuItem,{isDisabled:!0,key:"no result"},"No results found"));const g=a.createElement(o.Menu,{onSelect:(e,t)=>{"string"==typeof t&&(r(t),n(!1))},"data-id":"model-version-selector-menu",ref:m,isScrollable:!0,activeItemId:t.id},a.createElement(o.MenuSearch,null,a.createElement(o.MenuSearchInput,null,a.createElement(o.SearchInput,{"data-testid":"search-input",value:i,"aria-label":"Filter menu items",placeholder:"Find by version name",onChange:(e,t)=>s(t)}))),a.createElement(o.Divider,null),a.createElement(o.MenuContent,null,a.createElement(o.MenuList,{"data-testid":"model-version-selector-list"},E,a.createElement(o.MenuItem,null,a.createElement(qe,{rmId:e,totalVersions:c.items.length})))));return a.createElement(o.MenuContainer,{isOpen:l,toggleRef:d,toggle:a.createElement(o.MenuToggle,{id:"model-version-selector",ref:d,onClick:()=>n(!l),isExpanded:l,isFullWidth:!0,"data-testid":"model-version-toggle-button"},a.createElement(o.Flex,{spaceItems:{default:"spaceItemsSm"}},a.createElement(o.FlexItem,null,t.name),a.createElement(o.FlexItem,null,p&&t.id===p.id&&a.createElement(o.Badge,{color:"blue"},"Latest")))),menu:g,menuRef:m,onOpenChange:e=>n(e)})};var It=r(45848);const Ct=({customProperties:e={},isArchive:t,saveEditedCustomProperties:r})=>a.createElement(o.DescriptionListGroup,null,a.createElement(o.DescriptionListDescription,null,a.createElement(He,{customProperties:e,isArchive:t,saveEditedCustomProperties:r,isExpandedByDefault:!0})));var Mt=r(10385),St=r(69327);const At=({modelArtifact:e,isModelCatalogAvailable:t})=>{const r=(0,Mt.Yx)(e);if(!r)return null;const a=l().createElement("span",{className:"pf-v6-u-font-weight-bold","data-testid":"registered-from-catalog"},r.modelName),o=(()=>{const e=(0,St.S)({modelName:r.modelName,sourceId:r.sourceId});return l().createElement(l().Fragment,null,t?l().createElement(n.Link,{to:e},a):a," ","in Model catalog")})();return l().createElement(we.A,{title:"Registered from",groupTestId:"registered-from-title"},o)},Tt=({modelVersion:e,isArchiveVersion:t,refresh:r,modelArtifacts:l})=>{const n=l.items.length?l.items[0]:null,{apiState:i}=a.useContext($.m),s=(0,A.It)(n?.uri||""),[d,m,c]=pe(e.registeredModelId),u=c;if(!m)return a.createElement(o.Bullseye,null,a.createElement(o.Spinner,{size:"xl"}));const p=async t=>{await t,e.registeredModelId&&d&&(await(0,Ee.Us)(i.api,d),r())},E=async t=>{try{await t,d&&(await(0,Ee.N$)(i.api,d,e),r())}catch(e){throw new Error(`Failed to update artifact: ${e instanceof Error?e.message:String(e)}`)}};return a.createElement(o.Stack,{hasGutter:!0},d&&a.createElement(o.StackItem,null,a.createElement(Ke,{registeredModel:d,refresh:r,isArchiveModel:t,isExpandable:!0})),a.createElement(o.StackItem,null,a.createElement(o.Card,null,a.createElement(o.CardHeader,null,a.createElement(o.Title,{headingLevel:"h2"},"Version details")),a.createElement(o.CardBody,null,a.createElement(o.Flex,{direction:{default:"column",md:"row"},columnGap:{default:"columnGap4xl"},rowGap:{default:"rowGapLg"}},a.createElement(o.FlexItem,{flex:{default:"flex_1"}},a.createElement(o.DescriptionList,{isFillColumns:!0},a.createElement(ke.A,{labels:(0,S.IV)(e.customProperties),isArchive:t,allExistingKeys:Object.keys(e.customProperties),title:"Labels",contentWhenEmpty:"No labels",labelProps:{variant:"outline"},onLabelsChange:t=>p(i.api.patchModelVersion({},{customProperties:(0,S.Dh)(e.customProperties,t)},e.id)),"data-testid":"model-version-labels"}),a.createElement(Re.A,{editableVariant:"TextArea",baseTestId:"model-version-description",isArchive:t,title:"Description",contentWhenEmpty:"No description",value:e.description||"",saveEditedValue:t=>p(i.api.patchModelVersion({},{description:t},e.id))}),n&&a.createElement(At,{modelArtifact:n,isModelCatalogAvailable:!0}),a.createElement(Ct,{isArchive:t,customProperties:e.customProperties,saveEditedCustomProperties:t=>i.api.patchModelVersion({},{customProperties:t},e.id).then(r)}))),a.createElement(o.Divider,{orientation:{default:"vertical"}}),a.createElement(o.FlexItem,{flex:{default:"flex_1"}},a.createElement(o.Title,{style:{margin:"1em 0"},headingLevel:o.ContentVariants.h3},"Model location"),u?a.createElement(o.Alert,{variant:"danger",isInline:!0,title:u.name},u.message):a.createElement(a.Fragment,null,a.createElement(o.DescriptionList,null,s?.s3Fields&&a.createElement(a.Fragment,null,a.createElement(we.A,{title:"Endpoint",isEmpty:!s.s3Fields.endpoint,contentWhenEmpty:"No endpoint"},a.createElement(It.A,{testId:"storage-endpoint",textToCopy:s.s3Fields.endpoint})),a.createElement(we.A,{title:"Region",isEmpty:!s.s3Fields.region,contentWhenEmpty:"No region"},a.createElement(It.A,{testId:"storage-region",textToCopy:s.s3Fields.region||""})),a.createElement(we.A,{title:"Bucket",isEmpty:!s.s3Fields.bucket,contentWhenEmpty:"No bucket"},a.createElement(It.A,{testId:"storage-bucket",textToCopy:s.s3Fields.bucket})),a.createElement(we.A,{title:"Path",isEmpty:!s.s3Fields.path,contentWhenEmpty:"No path"},a.createElement(It.A,{testId:"storage-path",textToCopy:s.s3Fields.path}))),(s?.uri||s?.ociUri)&&a.createElement(a.Fragment,null,a.createElement(we.A,{title:"URI",isEmpty:!n?.uri,contentWhenEmpty:"No URI"},a.createElement(It.A,{testId:"storage-uri",textToCopy:n?.uri||""})))),a.createElement(o.Divider,{style:{marginTop:"1em"}}),a.createElement(o.DescriptionList,null,a.createElement(Re.A,{editableVariant:"TextInput",baseTestId:"source-model-format",isArchive:t,value:n?.modelFormatName||"",saveEditedValue:e=>E(i.api.patchModelArtifact({},{modelFormatName:e},n?.id||"")),title:"Model format",contentWhenEmpty:"No model format specified"}),a.createElement(Re.A,{editableVariant:"TextInput",baseTestId:"source-model-version",value:n?.modelFormatVersion||"",isArchive:t,saveEditedValue:e=>E(i.api.patchModelArtifact({},{modelFormatVersion:e},n?.id||"")),title:"Model format version",contentWhenEmpty:"No model format version"}))),a.createElement(o.Divider,{style:{marginTop:"1em"}}),a.createElement(o.DescriptionList,{isFillColumns:!0,style:{marginTop:"1em"}},a.createElement(we.A,{title:"Author",popover:"The author is the user who registered the model version."},e.author),a.createElement(we.A,{title:"Version ID",isEmpty:!e.id,contentWhenEmpty:"No model ID"},a.createElement(It.A,{testId:"model-version-id",textToCopy:e.id})),a.createElement(we.A,{title:"Last modified",isEmpty:!e.lastUpdateTimeSinceEpoch,contentWhenEmpty:"Unknown"},a.createElement(X.A,{timeSinceEpoch:e.lastUpdateTimeSinceEpoch})),a.createElement(we.A,{title:"Registered",isEmpty:!e.createTimeSinceEpoch,contentWhenEmpty:"Unknown"},a.createElement(X.A,{timeSinceEpoch:e.createTimeSinceEpoch})))))))))},kt=({tab:e,modelVersion:t,isArchiveVersion:r,refresh:l,modelArtifacts:i})=>{const s=(0,n.useNavigate)(),d=(0,h.useExtensions)(pt.F),{registeredModelId:m}=(0,n.useParams)(),{preferredModelRegistry:c}=a.useContext(v.j),u=[a.createElement(o.Tab,{key:ht.DETAILS,eventKey:ht.DETAILS,title:a.createElement(o.TabTitleText,null,vt.DETAILS),"aria-label":"Model versions details tab","data-testid":"model-versions-details-tab"},a.createElement(o.PageSection,{hasBodyWrapper:!1,isFilled:!0,"data-testid":"model-versions-details-tab-content"},a.createElement(Tt,{modelVersion:t,refresh:l,isArchiveVersion:r,modelArtifacts:i}))),...d.map(e=>a.createElement(o.Tab,{key:e.properties.id,eventKey:e.properties.id,"aria-label":`${e.properties.title} tab`,"data-testid":`${e.properties.id}-tab`,title:a.createElement(o.TabTitleText,null,e.properties.title)},a.createElement(o.PageSection,{hasBodyWrapper:!1,isFilled:!0,"data-testid":`${e.properties.id}-tab-content`},a.createElement(h.LazyCodeRefComponent,{component:e.properties.component,props:{rmId:m,mvId:t.id,mrName:c?.name}}))))];return a.createElement(o.Tabs,{activeKey:e,"aria-label":"Model versions details page tabs",role:"region","data-testid":"model-versions-details-page-tabs",onSelect:(e,t)=>s(`../${t}`,{relative:"path"})},u)},Rt=e=>"InferenceService"===e?.model?.kind,wt=({mv:e,setIsArchiveModalOpen:t})=>{const{registeredModelId:r}=(0,n.useParams)(),[l,i]=Ae(r),{hasModelVersionDeployment:s,hasRegisteredModelDeploymentByVersionIds:d,loaded:m}=(()=>{const{deployments:e,loaded:t}=nt(),r=a.useCallback(r=>{if(!t||!e)return{hasDeployment:!0,loaded:t};if(0===r.length)return{hasDeployment:!1,loaded:t};const a=new Set(r);return{hasDeployment:e.some(e=>{if(!Rt(e))return!1;const t=e.model?.metadata?.labels?.[ot.MODEL_VERSION_ID];return t&&a.has(t)}),loaded:t}},[e,t]);return{hasModelVersionDeployment:a.useCallback(e=>r([e]),[r]),hasRegisteredModelDeployment:a.useCallback((a,l)=>{if(!t||!e)return{hasDeployment:!0,loaded:t};if(e.some(e=>{if(!Rt(e))return!1;const t=e.model?.metadata?.labels?.[ot.REGISTERED_MODEL_ID];return t===a}))return{hasDeployment:!0,loaded:t};const n=l.filter(e=>e.registeredModelId===a).map(e=>e.id);return r(n)},[e,t,r]),hasRegisteredModelDeploymentByVersionIds:r,loaded:t,deployments:e}})(),c=a.useMemo(()=>i&&l?.items?l.items.map(e=>e.id):[],[i,l?.items]),{hasDeployment:u,isLoading:p}=a.useMemo(()=>{if(e){const t=s(e.id);return{hasDeployment:t.hasDeployment,isLoading:!t.loaded}}if(r){if(i){const e=d(c);return{hasDeployment:e.hasDeployment,isLoading:!e.loaded}}return{hasDeployment:!0,isLoading:!0}}return{hasDeployment:!1,isLoading:!1}},[e,e?.id,r,i,c,s,d,m]),E=p||u;return a.createElement(o.DropdownItem,{id:`${e?"archive-version-button":"archive-model-button"}-${e?.id??r??"global"}`,"aria-label":e?"Archive model version":"Archive model",onClick:()=>t(!0),isAriaDisabled:E,tooltipProps:!p&&u?{content:e?"Deployed model versions cannot be archived.":"Models with deployed versions cannot be archived."}:void 0},e?"Archive model version":"Archive model")},Dt=({mv:e,setIsArchiveModalOpen:t})=>a.createElement(wt,{mv:e,setIsArchiveModalOpen:t}),xt=({mv:e})=>{const{apiState:t}=a.useContext($.m),{preferredModelRegistry:r}=a.useContext(v.j),l=(0,n.useNavigate)(),[i,s]=a.useState(!1),[d,m]=a.useState(!1);return r?a.createElement(o.ActionList,{className:"pf-v5-u-display-flex"},a.createElement(o.ActionListGroup,{className:"pf-v5-u-flex-1"},a.createElement(o.ActionListItem,null,a.createElement(o.Dropdown,{isOpen:i,onSelect:()=>s(!1),onOpenChange:e=>s(e),popperProps:{position:"right",appendTo:"inline"},toggle:e=>a.createElement(o.MenuToggle,{variant:o.ButtonVariant.secondary,ref:e,onClick:()=>s(!i),isExpanded:i,"aria-label":"Model version details action toggle","data-testid":"model-version-details-action-button"},"Actions")},a.createElement(o.DropdownList,null,a.createElement(Dt,{mv:e,setIsArchiveModalOpen:m}))))),d&&a.createElement(et,{onCancel:()=>m(!1),onSubmit:()=>t.api.patchModelVersion({},{state:Z.ve.ARCHIVED},e.id).then(()=>l((0,f.fY)(e.registeredModelId,r.name))),modelVersionName:e.name})):null},Vt=({mv:e})=>l().createElement(ve,{mv:e,render:(e,t,r)=>{const a=l().createElement(o.Button,{id:"deploy-button","aria-label":"Deploy version",variant:o.ButtonVariant.primary,onClick:t,isAriaDisabled:!e?.enabled,"data-testid":"deploy-button"},"Deploy");return r?l().createElement(o.FlexItem,null,e.tooltip?l().createElement(o.Tooltip,{content:e.tooltip},a):a):null}}),Lt=({tab:e,...t})=>{const r=(0,n.useNavigate)(),{preferredModelRegistry:s}=l().useContext(v.j),{modelVersionId:d,registeredModelId:m}=(0,n.useParams)(),[c]=pe(m),[u,p,E,g]=yt(d),[b,h,y,I]=ue(d),C=l().useCallback(()=>{g(),I()},[g,I]),M=p&&h,S=E||y;return(0,a.useEffect)(()=>{c?.state===Z.ve.ARCHIVED&&u?.id?r((0,f.TR)(u.id,u.registeredModelId,s?.name)):u?.state===Z.ve.ARCHIVED&&r((0,f.Zf)(u.id,u.registeredModelId,s?.name))},[c?.state,u?.id,u?.state,u?.registeredModelId,s?.name,r]),l().createElement(i.A,{...t,breadcrumb:l().createElement(o.Breadcrumb,null,l().createElement(o.BreadcrumbItem,{render:()=>l().createElement(n.Link,{to:"/model-registry"},"Model registry - ",s?.name)}),l().createElement(o.BreadcrumbItem,{"data-testid":"breadcrumb-model-version",render:()=>l().createElement(n.Link,{to:(0,f.Pc)(m,s?.name)},c?.name||"Loading...")}),l().createElement(o.BreadcrumbItem,{"data-testid":"breadcrumb-version-name",isActive:!0},u?.name||"Loading...")),title:l().createElement(o.Flex,{alignItems:{default:"alignItemsCenter"}},l().createElement(o.FlexItem,null,l().createElement(o.Title,{headingLevel:"h1",size:"xl"},c?.name||"Loading...")),l().createElement(o.FlexItem,null,u&&l().createElement(ft,{rmId:m,selection:u,onSelect:e=>r((0,f.lh)(e,m,s?.name))}))),headerAction:M&&u&&l().createElement(o.Flex,{spaceItems:{default:"spaceItemsMd"},alignItems:{default:"alignItemsFlexStart"}},l().createElement(Vt,{mv:u}),l().createElement(o.FlexItem,null,l().createElement(xt,{mv:u}))),description:l().createElement(o.Truncate,{content:u?.description||""}),loadError:S,loaded:M,provideChildrenPadding:!0},null!==u&&l().createElement(kt,{tab:e,modelVersion:u,refresh:C,modelArtifacts:b}))},Nt=e=>{const{preferredModelRegistry:t}=l().useContext(v.j),{modelVersionId:r,registeredModelId:a}=(0,n.useParams)(),o=l().useMemo(()=>{if(r&&a)return{[ot.MODEL_VERSION_ID]:r,[ot.REGISTERED_MODEL_ID]:a}},[r,a]);return l().createElement(it,{labelSelectors:o,mrName:t?.name},l().createElement(Lt,{...e}))},Ft=({clearFilters:e,modelVersions:t,toolbarContent:r,refresh:l})=>a.createElement(N.A,{"data-testid":"model-versions-archive-table",data:t,columns:mt,toolbarContent:r,enablePagination:!0,onClearFilters:e,emptyTableView:a.createElement(F.A,{onClearFilters:e}),defaultSortColumn:1,rowRenderer:e=>a.createElement(at,{key:e.name,modelVersion:e,isArchiveRow:!0,refresh:l})}),Pt=({modelVersions:e,refresh:t})=>{const[r,l]=a.useState(D),n=a.useCallback((e,t)=>l(r=>({...r,[e]:t})),[l]),i=a.useCallback(()=>l(D),[l]),s=(0,S.PN)(e,r);return 0===e.length?a.createElement(C,{headerIcon:ce.WI,testid:"empty-archive-state",title:"No archived versions",description:"You can archive the active versions that you no longer use. You can restore archived versions to make it active."}):a.createElement(Ft,{refresh:t,clearFilters:i,modelVersions:s,toolbarContent:a.createElement(o.Toolbar,{"data-testid":"model-versions-archive-table-toolbar",clearAllFilters:i},a.createElement(o.ToolbarContent,null,a.createElement(o.ToolbarToggleGroup,{toggleIcon:a.createElement(x.YG,null),breakpoint:"xl"},a.createElement(o.ToolbarGroup,{variant:"filter-group"},a.createElement(V,{filterOptions:w,filterOptionRenders:{[R.keyword]:({onChange:e,...t})=>a.createElement(L.A,{...t,fieldLabel:"Filter by keyword",placeholder:"Filter by keyword",className:"toolbar-fieldset-wrapper",style:{minWidth:"270px"},onChange:t=>e(t)}),[R.author]:({onChange:e,...t})=>a.createElement(L.A,{...t,fieldLabel:"Filter by author",placeholder:"Filter by author",className:"toolbar-fieldset-wrapper",style:{minWidth:"270px"},onChange:t=>e(t)})},filterData:r,onFilterUpdate:n})))))})},Ot=({...e})=>{const{preferredModelRegistry:t}=l().useContext(v.j),{registeredModelId:r}=(0,Ze.useParams)(),[a]=pe(r),[s,d,m,c]=Ae(r);return l().createElement(i.A,{...e,breadcrumb:l().createElement(o.Breadcrumb,null,l().createElement(o.BreadcrumbItem,{render:()=>l().createElement(n.Link,{to:"/model-registry"},"Model registry - ",t?.name)}),l().createElement(o.BreadcrumbItem,{render:()=>l().createElement(n.Link,{to:(0,f.Pc)(r,t?.name)},a?.name||"Loading...")}),l().createElement(o.BreadcrumbItem,{"data-testid":"archive-version-page-breadcrumb",isActive:!0},"Archived versions")),title:a?`Archived versions of ${a.name}`:"Archived versions",loadError:m,loaded:d,provideChildrenPadding:!0},a&&l().createElement(Pt,{modelVersions:(0,A.SD)(s.items),refresh:c}))},Bt=({preferredModelRegistry:e,registeredModel:t,modelVersionName:r})=>l().createElement(o.Breadcrumb,null,l().createElement(o.BreadcrumbItem,{render:()=>l().createElement(n.Link,{to:"/model-registry"},"Model registry - ",e)}),l().createElement(o.BreadcrumbItem,{render:()=>l().createElement(n.Link,{to:(0,f.Pc)(t?.id,e)},t?.name||"Loading...")}),l().createElement(o.BreadcrumbItem,{render:()=>l().createElement(n.Link,{to:(0,f.xi)(t?.id,e)},"Archived versions")}),l().createElement(o.BreadcrumbItem,{isActive:!0},r||"Loading...")),Gt=({tab:e,...t})=>{const{preferredModelRegistry:r}=l().useContext(v.j),{apiState:n}=l().useContext($.m),s=(0,Ze.useNavigate)(),{modelVersionId:d,registeredModelId:m}=(0,Ze.useParams)(),[c]=pe(m),[u,p,E,g]=yt(d),[b,h,y,I]=ue(d),[C,M]=l().useState(!1),S=l().useCallback(()=>{g(),I()},[g,I]),A=p&&h,T=E||y;return(0,a.useEffect)(()=>{c?.state===Z.ve.ARCHIVED&&u?.id?s((0,f.TR)(u.id,u.registeredModelId,r?.name)):u?.state===Z.ve.LIVE&&s((0,f.lh)(u.id,u.registeredModelId,r?.name))},[c?.state,u?.state,u?.id,u?.registeredModelId,r?.name,s]),l().createElement(l().Fragment,null,l().createElement(i.A,{...t,breadcrumb:l().createElement(Bt,{preferredModelRegistry:r?.name,registeredModel:c,modelVersionName:u?.name}),title:u&&l().createElement(o.Flex,{alignItems:{default:"alignItemsCenter"}},l().createElement(o.FlexItem,null,u.name),l().createElement(o.Label,null,"Archived")),headerAction:l().createElement(o.Button,{"data-testid":"restore-button",onClick:()=>M(!0)},"Restore model version"),description:l().createElement(o.Truncate,{content:u?.description||""}),loadError:T,loaded:A,provideChildrenPadding:!0},null!==u&&l().createElement(kt,{isArchiveVersion:!0,tab:e,modelVersion:u,refresh:S,modelArtifacts:b})),null!==u&&C?l().createElement(tt,{onCancel:()=>M(!1),onSubmit:()=>n.api.patchModelVersion({},{state:Z.ve.LIVE},u.id).then(()=>s((0,f.lh)(u.id,c?.id,r?.name))),modelVersionName:u.name}):null)},jt=({preferredModelRegistry:e,registeredModel:t,modelVersionName:r})=>l().createElement(o.Breadcrumb,null,l().createElement(o.BreadcrumbItem,{render:()=>l().createElement(n.Link,{to:"/model-registry"},"Model registry - ",e)}),l().createElement(o.BreadcrumbItem,{render:()=>l().createElement(n.Link,{to:(0,f.j1)(e)},"Archived models")}),l().createElement(o.BreadcrumbItem,{render:()=>l().createElement(n.Link,{to:(0,f.Vd)(t?.id,e)},t?.name||"Loading...")}),l().createElement(o.BreadcrumbItem,{isActive:!0},r||"Loading...")),_t=({tab:e,...t})=>{const{preferredModelRegistry:r}=l().useContext(v.j),{modelVersionId:n,registeredModelId:s}=(0,Ze.useParams)(),[d]=pe(s),[m,c,u,p]=yt(n),[E,g,b,h]=ue(n),y=(0,Ze.useNavigate)(),I=l().useCallback(()=>{p(),h()},[p,h]),C=c&&g,M=u||b;return(0,a.useEffect)(()=>{d?.state===Z.ve.LIVE&&m?.id&&y((0,f.lh)(m.id,m.registeredModelId,r?.name))},[d?.state,m?.id,m?.registeredModelId,r?.name,y]),l().createElement(i.A,{...t,breadcrumb:l().createElement(jt,{preferredModelRegistry:r?.name,registeredModel:d,modelVersionName:m?.name}),title:m&&l().createElement(o.Flex,null,l().createElement(o.FlexItem,null,l().createElement(o.Content,null,m.name)),l().createElement(o.FlexItem,null,l().createElement(o.Label,null,"Archived"))),headerAction:l().createElement(o.Tooltip,{content:"The version of an archived model cannot be restored unless the model is restored."},l().createElement(o.Button,{"data-testid":"restore-button","aria-label":"restore version",isAriaDisabled:!0},"Restore version")),description:l().createElement(o.Truncate,{content:m?.description||""}),loadError:M,loaded:C,provideChildrenPadding:!0},null!==m&&l().createElement(kt,{isArchiveVersion:!0,tab:e,modelVersion:m,refresh:I,modelArtifacts:E}))},$t=({preferredModelRegistry:e,registeredModel:t})=>l().createElement(o.Breadcrumb,null,l().createElement(o.BreadcrumbItem,{render:()=>l().createElement(n.Link,{to:"/model-registry"},"Model registry - ",e)}),l().createElement(o.BreadcrumbItem,{render:()=>l().createElement(n.Link,{to:(0,f.j1)(e)},"Archived models")}),l().createElement(o.BreadcrumbItem,{isActive:!0},t?.name||"Loading...")),Wt=({tab:e,...t})=>{const{preferredModelRegistry:r}=l().useContext(v.j),{apiState:n}=l().useContext($.m),s=(0,Ze.useNavigate)(),{registeredModelId:d}=(0,Ze.useParams)(),[m,c,u,p]=pe(d),[E,g,b,h]=Ae(d),[y,I]=l().useState(!1);return(0,a.useEffect)(()=>{m?.state===Z.ve.LIVE&&s((0,f.Pc)(m.id,r?.name))},[m?.state,r?.name,m?.id,s]),l().createElement(l().Fragment,null,l().createElement(i.A,{...t,breadcrumb:l().createElement($t,{preferredModelRegistry:r?.name,registeredModel:m}),title:m&&l().createElement(o.Flex,{alignItems:{default:"alignItemsCenter"}},l().createElement(o.FlexItem,null,m.name),l().createElement(o.Label,null,"Archived")),headerAction:l().createElement(o.Button,{"data-testid":"restore-button",onClick:()=>I(!0)},"Restore model"),description:l().createElement(o.Truncate,{content:m?.description||""}),loadError:u,loaded:c,provideChildrenPadding:!0},null!==m&&g&&!b&&l().createElement(Et,{tab:e,isArchiveModel:!0,registeredModel:m,modelVersions:E.items,refresh:p,mvRefresh:h})),null!==m&&y?l().createElement(J,{onCancel:()=>I(!1),onSubmit:()=>n.api.patchRegisteredModel({},{state:Z.ve.LIVE},m.id).then(()=>s((0,f.Pc)(m.id,r?.name))),registeredModelName:m.name}):null)};var Ut=r(12895),Ht=r(77353),Kt=r(32853),zt=r(24828),Yt=r(60822),qt=r(41215);const Xt=({mrName:e})=>{const t=l().createElement(o.TextInput,{isDisabled:!0,isRequired:!0,type:"text",id:"mr-name",name:"mr-name",value:e});return l().createElement(o.FormGroup,{className:"form-group-disabled",label:"Model registry",isRequired:!0,fieldId:"mr-name"},l().createElement(je.A,{component:t,field:"Model Registry"}))};var Jt=r(87731);const Zt=()=>{const{modelRegistry:e}=(0,Ze.useParams)(),t=(0,Ze.useNavigate)(),{apiState:r}=l().useContext($.m),{user:a}=l().useContext(Ut.B),s=a.userId||"",[d,c]=l().useState(!1),[u,p]=l().useState(void 0),[E,g]=(0,Ht.CN)(),[b,h]=l().useState(""),[v,y]=l().useState(""),[I,C]=l().useState(void 0),[M,S,A]=(0,m.A)(),T=(0,Kt.wJ)(E.modelName),k=(0,Kt.oV)(E.modelName,M),R=!T||k,w=d||(0,Kt.fB)(E,M);return l().createElement(i.A,{title:"Register model",description:"Create and register the first version of a new model.",breadcrumb:l().createElement(o.Breadcrumb,null,l().createElement(o.BreadcrumbItem,{render:()=>l().createElement(n.Link,{to:(0,f.C3)(e)},"Model registry - ",e)}),l().createElement(o.BreadcrumbItem,null,"Register model")),loaded:S,loadError:A,empty:!1},l().createElement(o.PageSection,{hasBodyWrapper:!1,isFilled:!0},l().createElement(o.Form,{isWidthLimited:!0},l().createElement(o.Stack,{hasGutter:!0},l().createElement(o.StackItem,{className:Fe.A.mbLg},l().createElement(Xt,{mrName:e})),l().createElement(o.StackItem,null,l().createElement(Jt.A,{formData:E,setData:g,hasModelNameError:R,isModelNameDuplicate:k}),l().createElement(zt.A,{formData:E,setData:g,isFirstVersion:!0}))))),l().createElement(Yt.A,{submitLabel:qt.Fu.REGISTER_MODEL,submitError:u,isSubmitDisabled:w,isSubmitting:d,onSubmit:async()=>{c(!0),p(void 0);const{data:{registeredModel:a,modelVersion:l,modelArtifact:n},errors:o}=await(0,Kt.$R)(r,E,s);if(a&&l&&n)t((0,f.lh)(l.id,a.id,e));else if(Object.keys(o).length>0){c(!1),h(E.modelName),y(E.versionName);const e=Object.keys(o)[0];C(e),p(o[e])}},onCancel:()=>{t((0,f.C3)(e))},registrationErrorType:I,versionName:v,modelName:b}))};var Qt=r(93707);const er=({registeredModels:e,registeredModelId:t,setRegisteredModelId:r,isDisabled:a})=>{const n=l().useMemo(()=>e.map(({name:e,id:r})=>({content:e,value:r,isSelected:r===t})),[e,t]),i=l().createElement(o.TextInput,{isDisabled:!0,isRequired:!0,type:"text",id:"model-name",name:"registered-model-prefilled",value:n.find(({value:e})=>e===t)?.content});return a&&t?l().createElement(o.FormGroup,{label:"Model name",className:"form-group-disabled",isRequired:!0,fieldId:"model-name"},l().createElement(je.A,{component:i,field:"Model Name"})):l().createElement(Qt.A,{id:"model-name",onClearSelection:()=>r(""),selectOptions:n,isScrollable:!0,placeholder:"Select a registered model",noOptionsFoundMessage:e=>`No results found for "${e}"`,onSelect:(e,t)=>{r(String(t))}})},tr=()=>{const{modelRegistry:e,registeredModelId:t}=(0,Ze.useParams)(),r=(0,Ze.useNavigate)(),{apiState:a}=l().useContext($.m),{user:s}=l().useContext(Ut.B),d=s.userId||"",[c,u]=l().useState(!1),[p,E]=(0,Ht.vO)(t),g=c||(0,Kt.Gs)(p),[b,h]=l().useState(void 0),[v,y]=l().useState(""),[I,C]=l().useState(void 0),{registeredModelId:M}=p,[S,T,k]=(0,m.A)(),R=(0,A.BT)(S.items),w=R.find(({id:e})=>e===M),{loadedPrefillData:D,loadPrefillDataError:x,latestVersion:V}=(({registeredModel:e,setData:t})=>{const[r,a,n]=Ae(e?.id),o=(0,A._u)(r.items),i=(0,A._N)(o),[s,d,m]=ue(i?.id),c=(0,A._N)(s.items),u=!(!e||a&&(!i||d)),p=n||m,E=l().useRef();return l().useEffect(()=>{if(e&&e.id!==E.current&&!u)if(E.current=e.id,c){t("sourceModelFormat",c.modelFormatName||""),t("sourceModelFormatVersion",c.modelFormatVersion||"");const e=c.uri&&(0,A.It)(c.uri)||null;t("modelLocationType",Ht.Ht.ObjectStorage),e?.s3Fields?(t("modelLocationEndpoint",e.s3Fields.endpoint),t("modelLocationBucket",e.s3Fields.bucket),t("modelLocationRegion",e.s3Fields.region||"")):(t("modelLocationEndpoint",""),t("modelLocationBucket",""),t("modelLocationRegion",""))}else t("sourceModelFormat",""),t("sourceModelFormatVersion",""),t("modelLocationType",Ht.Ht.ObjectStorage),t("modelLocationEndpoint",""),t("modelLocationBucket",""),t("modelLocationRegion","")},[e,u,c,t]),{loadedPrefillData:!u,loadPrefillDataError:p,latestVersion:i,latestArtifact:c}})({registeredModel:w,setData:E});return l().createElement(i.A,{title:"Register new version",description:"Register a latest version to the model you selected below.",breadcrumb:l().createElement(o.Breadcrumb,null,l().createElement(o.BreadcrumbItem,{render:()=>l().createElement(n.Link,{to:(0,f.C3)(e)},"Model registry - ",e)}),t&&w&&l().createElement(o.BreadcrumbItem,{render:()=>l().createElement(n.Link,{to:(0,f.Pc)(w.id,e)},w.name)}),l().createElement(o.BreadcrumbItem,null,"Register new version")),loadError:k||x,loaded:T,empty:!1},l().createElement(o.PageSection,{hasBodyWrapper:!1,isFilled:!0},l().createElement(o.Form,{isWidthLimited:!0},l().createElement(o.Stack,{hasGutter:!0},l().createElement(o.StackItem,null,l().createElement(Xt,{mrName:e})),l().createElement(o.StackItem,{className:Fe.A.mbLg},l().createElement(o.FormGroup,{id:"registered-model-container",isRequired:!0,fieldId:"model-name",labelHelp:D?void 0:l().createElement(o.Spinner,{size:"sm",className:Fe.A.mlMd})},l().createElement(er,{registeredModels:R,registeredModelId:M,setRegisteredModelId:e=>E("registeredModelId",e),isDisabled:!!t}))),l().createElement(o.StackItem,null,l().createElement(zt.A,{formData:p,setData:E,isFirstVersion:!1,latestVersion:V}))))),l().createElement(Yt.A,{submitLabel:qt.Fu.REGISTER_VERSION,registrationErrorType:I,submitError:b,isSubmitDisabled:g,isSubmitting:c,onSubmit:async()=>{if(!w)return;u(!0),h(void 0);const{data:{modelVersion:t,modelArtifact:l},errors:n}=await(0,Kt.KO)(a,w,p,d);if(t&&l)r((0,f.Pc)(w.id,e));else if(Object.keys(n).length>0){const e=Object.keys(n)[0];y(p.versionName),C(e),h(n[e]),u(!1)}},onCancel:()=>r(t&&w?(0,f.Pc)(w.id,e):(0,f.C3)(e)),versionName:v}))},rr=({isModelVersionsArchiveDetails:e,isArchiveModelVersionDetails:t,tabExtensions:r})=>r.map(r=>l().createElement(n.Route,{key:r.properties.id,path:r.properties.id,element:e?l().createElement(Gt,{tab:r.properties.id,empty:!1}):t?l().createElement(_t,{tab:r.properties.id,empty:!1}):l().createElement(Nt,{tab:r.properties.id,empty:!1})})),ar=()=>{const e=(0,h.useExtensions)(pt.F),t=(0,h.useExtensions)(pt.x);return a.createElement(n.Routes,null,a.createElement(n.Route,{path:"/:modelRegistry?/*",element:a.createElement(me,{getInvalidRedirectPath:e=>(0,f.C3)(e)})},a.createElement(n.Route,{index:!0,element:a.createElement(le,{empty:!1})}),a.createElement(n.Route,{path:"registeredModels/:registeredModelId"},a.createElement(n.Route,{index:!0,element:a.createElement(n.Navigate,{to:Me.OVERVIEW,replace:!0})}),a.createElement(n.Route,{path:Me.VERSIONS,element:a.createElement(bt,{tab:Me.VERSIONS,empty:!1})}),a.createElement(n.Route,{path:Me.OVERVIEW,element:a.createElement(bt,{tab:Me.OVERVIEW,empty:!1})}),(({tabExtensions:e})=>e.map(e=>l().createElement(n.Route,{key:e.properties.id,path:e.properties.id,element:l().createElement(bt,{tab:e.properties.id,empty:!1})})))({tabExtensions:t}),a.createElement(n.Route,{path:"registerVersion",element:a.createElement(tr,null)}),a.createElement(n.Route,{path:"versions/:modelVersionId"},a.createElement(n.Route,{index:!0,element:a.createElement(n.Navigate,{to:ht.DETAILS,replace:!0})}),a.createElement(n.Route,{path:ht.DETAILS,element:a.createElement(Nt,{tab:ht.DETAILS,empty:!1})}),rr({tabExtensions:e}),a.createElement(n.Route,{path:"*",element:a.createElement(n.Navigate,{to:"."})})),a.createElement(n.Route,{path:"versions/archive"},a.createElement(n.Route,{index:!0,element:a.createElement(Ot,{empty:!1})}),a.createElement(n.Route,{path:":modelVersionId"},a.createElement(n.Route,{index:!0,element:a.createElement(n.Navigate,{to:ht.DETAILS,replace:!0})}),a.createElement(n.Route,{path:ht.DETAILS,element:a.createElement(Gt,{tab:ht.DETAILS,empty:!1})}),rr({tabExtensions:e,isModelVersionsArchiveDetails:!0}),a.createElement(n.Route,{path:"*",element:a.createElement(n.Navigate,{to:"."})})),a.createElement(n.Route,{path:"*",element:a.createElement(n.Navigate,{to:"."})})),a.createElement(n.Route,{path:"*",element:a.createElement(n.Navigate,{to:"."})})),a.createElement(n.Route,{path:"registeredModels/archive"},a.createElement(n.Route,{index:!0,element:a.createElement(Ce,{empty:!1})}),a.createElement(n.Route,{path:":registeredModelId"},a.createElement(n.Route,{index:!0,element:a.createElement(n.Navigate,{to:Me.OVERVIEW,replace:!0})}),a.createElement(n.Route,{path:Me.OVERVIEW,element:a.createElement(Wt,{tab:Me.OVERVIEW,empty:!1})}),a.createElement(n.Route,{path:Me.VERSIONS,element:a.createElement(Wt,{tab:Me.VERSIONS,empty:!1})}),a.createElement(n.Route,{path:"versions/:modelVersionId"},a.createElement(n.Route,{index:!0,element:a.createElement(n.Navigate,{to:ht.DETAILS,replace:!0})}),a.createElement(n.Route,{path:ht.DETAILS,element:a.createElement(_t,{tab:ht.DETAILS,empty:!1})}),rr({tabExtensions:e,isArchiveModelVersionDetails:!0}),a.createElement(n.Route,{path:"*",element:a.createElement(n.Navigate,{to:"."})})),a.createElement(n.Route,{path:"*",element:a.createElement(n.Navigate,{to:"."})})),a.createElement(n.Route,{path:"*",element:a.createElement(n.Navigate,{to:"."})})),a.createElement(n.Route,{path:"registerModel",element:a.createElement(Zt,null)}),a.createElement(n.Route,{path:"registerVersion",element:a.createElement(tr,null)}),a.createElement(n.Route,{path:"*",element:a.createElement(n.Navigate,{to:"."})})))}},6735:(e,t,r)=>{r.d(t,{a:()=>a});const a=e=>"model-registry.registered-models/table-column"===e.type},7384:(e,t,r)=>{r.d(t,{j:()=>l,s:()=>a});const a=e=>"model-registry.model-version/deploy-modal"===e.type,l=e=>"model-registry.model-version/deployments-context"===e.type},15041:(e,t,r)=>{r.d(t,{F:()=>a,x:()=>l});const a=e=>"model-registry.version-details/tab"===e.type,l=e=>"model-registry.details/tab"===e.type},40487:(e,t,r)=>{r.d(t,{S:()=>a});const a=e=>"model-registry.model-details/details-card"===e.type}}]);
//# sourceMappingURL=425.bundle.js.map